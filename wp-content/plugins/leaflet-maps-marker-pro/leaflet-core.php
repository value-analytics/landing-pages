<?php // Before trying to crack the plugin, please consider buying a pro license at https://www.mapsmarker.com/order - we have put hundreds of hours into the development of our plugin and without honest customers we will not be able to continue the development and support. Thanks for your understanding and your honesty!
if (basename($_SERVER["\123\103\122IPT_FIL\105\116\101ME"]) == "leafl\145\164\055core.\160\150\160") { exit ("Please d\157\040\156ot acc\145\163\163 this f\151\154\145 direc\164\154y. Than\153\163\041<br/\076\074\141 href\075\047https:\057\057www.ma\160\163\155arker\056\143om/go'>\167\167w.maps\155\141\162ker.c\157\155\074/a>"); } if (is_admin()) { include_once (ABSPATH."wp-ad\155\151n".DIRECTORY_SEPARATOR."includes".DIRECTORY_SEPARATOR."plugin.\160\150\160"); if (is_plugin_active("m\141\160\163-marker\055\160ro/maps\055\155\141rker-p\162\157\056php") || class_exists("\115\141ps_Mark\145\162\137Pro")) { $version=get_option("m\141\160\163marker\160\162\157_versio\156"); $version=($version) ? $version: ""; exit ( "\133\115\141ps Mark\145\162\040Pro 3.\061\056\061 - ac\164\151\166ation \146\141\151led]: \120\154\145ase de\141\143\164ivate\040\115\141ps Ma\162\153\145r Pr\157\040$version first\056"); } if (is_plugin_active("\154\145\141flet-m\141\160\163-marker\057\154\145aflet-m\141\160\163-marke\162\056\160hp")) { if (!is_multisite()) { deactivate_plugins("\154eaflet-m\141\160\163-marker\057\154\145aflet-m\141\160\163-marke\162\056\160hp",$silent=FALSE,$network_wide=NULL); activate_plugin("leafl\145\164\055maps-ma\162\153\145r-pro/l\145\141\146let-ma\160\163\055marke\162\056\160hp",$redirect="\160lugins.p\150\160\077activa\164\145\075true",$network_wide=FALSE,$silent=FALSE); } else { include_once (ABSPATH."\167\160-include\163".DIRECTORY_SEPARATOR."\160\154uggable.\160\150\160"); if (is_network_admin()) { deactivate_plugins("leaflet\055\155\141ps-mar\153\145\162/leafl\145\164\055maps-m\141\162\153er.php",$silent=FALSE,$network_wide=TRUE); activate_plugin("\154\145aflet-m\141\160\163-marker\055\160\162o/leaf\154\145\164-maps-\155\141\162ker.ph\160",$redirect=FALSE,$network_wide=TRUE,$silent=FALSE); } else { deactivate_plugins("leaf\154\145\164-maps-m\141\162\153er/lea\146\154\145t-maps-\155\141\162ker.ph\160",$silent=FALSE,$network_wide=NULL); activate_plugin("\154\145aflet-ma\160\163\055marke\162\055\160ro/leaf\154\145\164-maps-\155\141\162ker.ph\160",$redirect="plugins\056\160\150p?activ\141\164\145=true",$network_wide=FALSE,$silent=FALSE); } } } } $l0=wp_upload_dir(); define( "O0" ,"e43858\070\071351d"); define( "LEAFLET_WP_ADMIN_URL" ,get_admin_url()); define( "LEAFLET_PLUGIN_URL" ,plugin_dir_url( __FILE__)); define( "LEAFLET_PLUGIN_DIR" ,plugin_dir_path( __FILE__)); define( "LEAFLET_PLUGIN_ICONS_URL" ,$l0["\142\141seurl"]."/leafle\164\055\155aps-mark\145\162\055icons"); define( "LEAFLET_PLUGIN_ICONS_DIR" ,$l0["\142asedir"].DIRECTORY_SEPARATOR."\154eaflet-ma\160\163\055marker\055\151\143ons"); define( "l1" ,get_admin_url()); define( "O1" ,plugin_dir_url( __FILE__)); define( "l2" ,plugin_dir_path( __FILE__)); define( "O2" ,$l0["bas\145\165\162l"]."\057leaflet\055\155\141ps-mark\145\162\055icons"); define( "l3" ,$l0["\142asedir"].DIRECTORY_SEPARATOR."\154eaflet-\155\141\160s-marke\162\055\151cons"); function O3() { if ((substr($_SERVER["\122EMOTE\137\101\104DR"],0,4) == "1\062\067\056") || ($_SERVER["\122\105MOTE_AD\104\122"] == "::1")) { return TRUE; } else { return FALSE; } } class leafletmapsmarkerpro { function __construct() { $l4=get_option("\154\145afletma\160\163\155arker_\157\160\164ions"); require_once LEAFLET_PLUGIN_DIR."\151\156c".DIRECTORY_SEPARATOR."\143\154ass-mmp-\147\154\157bals.ph\160"; require_once LEAFLET_PLUGIN_DIR."i\156\143".DIRECTORY_SEPARATOR."cl\141\163\163-mmp-re\167\162\151te.php"; require_once LEAFLET_PLUGIN_DIR."\151nc".DIRECTORY_SEPARATOR."\143\154ass-googl\145\055\160laces\055\147\145ocoding\056\160\150p"; require_once LEAFLET_PLUGIN_DIR."inc".DIRECTORY_SEPARATOR."\143lass-mmp\141\160\151.php"; require_once LEAFLET_PLUGIN_DIR."\151\156c".DIRECTORY_SEPARATOR."\143\154ass-rest\141\160\151.php"; require_once LEAFLET_PLUGIN_DIR."\151\156\143".DIRECTORY_SEPARATOR."\143\154\141ss-mmp\055\162\145cent-ma\162\153\145rs-list\055\167\151dget.\160\150\160"; require_once LEAFLET_PLUGIN_DIR."inc".DIRECTORY_SEPARATOR."\143\154ass-mmp\055\154\141test-m\141\162\153er-map-\167\151\144get.ph\160"; if (is_admin()) { require_once LEAFLET_PLUGIN_DIR."inc".DIRECTORY_SEPARATOR."plugin-u\160\144\141te-che\143\153\145r".DIRECTORY_SEPARATOR."plugi\156\055\165pdate-c\150\145\143ker.php"; } if ( isset ($l4["misc_ti\156\171\155ce_butt\157\156"]) && $l4["misc_ti\156\171\155ce_butt\157\156"] == "\145\156\141bled") { require_once LEAFLET_PLUGIN_DIR."inc".DIRECTORY_SEPARATOR."\164\151\156ymce-p\154\165\147in.php"; } add_action("init",array(&$this,"\154\155m_load_\164\162\141nslatio\156\137\146iles"),1); add_action("ad\155\151\156_init",array(&$this,"\154\155\155_load_se\164\164\151ngs_cla\163\163"),2); add_action("\141\144\155in_init",array(&$this,"lmm_i\156\163\164all_a\156\144\137update\163"),3); if ( isset ($l4["google_a\160\151\137deregi\163\164\145r_scrip\164\163"]) && $l4["\147\157ogle_ap\151\137\144eregis\164\145\162_script\163"] == "\145\156abled") { add_action("\167\160_enqueue\137\163\143ripts",array(&$this,"\154\155m_deregi\163\164\145r_scrip\164\163"),4); add_action("wp_head",array(&$this,"\154mm_dereg\151\163\164er_scrip\164\163"),5); add_action("\151\156it",array(&$this,"\154\155\155_deregi\163\164\145r_scrip\164\163"),6); add_action("\167\160_footer",array(&$this,"\154\155\155_deregi\163\164\145r_scri\160\164\163"),7); add_action("\167p_prin\164\137\163cripts",array(&$this,"lmm_der\145\147\151ster_scr\151\160\164s"),8); } add_action("wp_enqu\145\165\145_script\163",array(&$this,"\154mm_fr\157\156\164end_enqu\145\165\145_script\163"),011); add_action("wp_prin\164\137\163tyles",array(&$this,"lmm_fro\156\164\145nd_enque\165\145\137styles\150\145\145ts"),012); add_action("\141\144\155in_menu",array(&$this,"\154mm_admi\156\137\155enu"),013); add_action("\141\144min_init",array(&$this,"lmm_p\154\165\147in_meta_\154\151\156ks"),014); add_action("\167p_ajax_m\141\160\163marker\137\141\152ax_acti\157\156\163_backe\156\144",array(&$this,"\154mm_ajax\137\141\143tions_ba\143\153\145nd"),015); add_action("\167p_ajax_\155\141\160smarker\137\141\152ax_acti\157\156\163_front\145\156\144",array(&$this,"lmm_\141\152\141x_action\163\137\146rontend"),016); add_action("wp_a\152\141\170_nopriv_\155\141\160smarker\137\141\152ax_acti\157\156\163_front\145\156\144",array(&$this,"l\155\155\137ajax_ac\164\151\157ns_fron\164\145\156d"),017); add_action("admin_bar\137\155\145nu",array(&$this,"\154\155\155_add_ad\155\151\156_bar_me\156\165"),0225); if (!empty($l4)) { if (!empty($l4["\163hortc\157\144\145"])) { add_shortcode($l4["\163hortcode"],array(&$this,"\154\155\155_showm\141\160")); } if ( isset ($l4["mi\163\143\137add_geor\163\163\137to_head"]) && $l4["\155isc_add_\147\145\157rss_to_\150\145\141d"] == "\145nabled") { add_action("\167\160_head",array(&$this,"\154\155\155_add_g\145\157\162ss_to_h\145\141\144")); } } add_filter("\167\151dget_tex\164","\144\157\137shortc\157\144\145"); if ( isset ($l4["misc_\147\154\157bal_adm\151\156\137notices"]) && $l4["misc_glo\142\141\154_admin_n\157\164\151ces"] == "\163how") { add_action("admin_n\157\164\151ces",array(&$this,"\154\155\155_compa\164\151\142ility_c\150\145\143ks")); } if ( isset ($l4["\155\151sc_plugi\156\137\154anguag\145"]) && $l4["misc_p\154\165\147in_lan\147\165\141ge"] != "\141utomati\143") { add_filter("plugin_l\157\143\141le",array(&$this,"\154mm_set_\160\154\165gin_loc\141\154\145"),"lmm"); } add_action("\167\151dgets_in\151\164",create_function("","\162eturn re\147\151\163ter_wi\144\147\145t(\042M\115\120\137Recent\137\115\141rkers_\114\151\163t_Widg\145\164\042);")); add_action("\167\151dgets_i\156\151\164",create_function("","\162eturn r\145\147\151ster_wid\147\145\164(\042MM\120\137\114atest_\115\141\162ker_Ma\160\137\127idget\042\051\073")); if ( isset ($l4["mi\163\143\137admin_d\141\163\150board_w\151\144\147et"]) && $l4["\155isc_admi\156\137\144ashboar\144\137\167idget"] == "enable\144") { if (!is_multisite()) { add_action("wp_d\141\163\150board_s\145\164\165p",array(&$this,"\154\155m_regist\145\162\137widgets")); } else { add_action("wp_n\145\164\167ork_das\150\142\157ard_set\165\160",array(&$this,"\154mm_regi\163\164\145r_widge\164\163")); add_action("wp_da\163\150\142oard_set\165\160",array(&$this,"lmm_\162\145\147ister_wi\144\147\145ts")); } } if ( isset ($l4["\155isc_po\151\156\164ers"]) && $l4["\155\151\163c_point\145\162\163"] == "\145\156\141bled") { $version_before_update=get_option("l\145\141\146letmaps\155\141\162ker_ver\163\151\157n_pro_b\145\146\157re_up\144\141\164e"); if ($version_before_update != "\060") { add_action("ad\155\151\156_enqueu\145\137\163cripts",array(&$this,"\154mm_update\137\160\157inter_a\144\155\151n_scrip\164\163"),01751); } } add_action("\141\144min_enq\165\145\165e_scri\160\164\163",array(&$this,"lmm_feat\165\162\145_pointer\137\141\144min_scr\151\160\164s"),01752); if (is_multisite()) { add_action("delet\145\137\142log",array(&$this,"\154\155\155_delete\137\155\165ltisite\137\142\154og")); } add_action("\164\145\155plate_i\156\143\154ude",array(&$this,"l\155\155\137templat\145\137\143heck_sh\157\162\164code")); add_action("plug\151\156\137row_met\141",array(&$this,"\154mm_plu\147\151\156s_page_\141\144\144_links"),012,2); add_filter("u\160\154\157ad_mime\163",array(&$this,"lmm\137\160\145rmit_mim\145\137\164ypes_on\137\165\160load")); add_filter("\160\157\163t_mime_\164\171\160es",array(&$this,"\154mm_modif\171\137\160ost_mim\145\137\164ypes")); if ( isset ($l4["xml_\163\151\164emaps_s\164\141\164us"]) && $l4["\170ml_sit\145\155\141ps_statu\163"] == "e\156\141\142led") { add_action("\163\155_buildma\160",array(&$this,"lmm\137\141\144d_kml_to\137\163\151temap")); } if (defined( "POLYLANG_VERSION")) { add_filter("gen\145\162\141te_rewr\151\164\145_rules",array("\115\115P_Rewri\164\145","\163\145t_pll_re\167\162\151te_rul\145\163")); add_filter("pll_rew\162\151\164e_rules",array("MMP_Rew\162\151\164e","pll_filt\145\162\137rewrite_\162\165\154es")); } else { add_action("\151\156it",array("\115\115\120_Rewri\164\145","\163et_rew\162\151\164e_rules")); } add_filter("query_\166\141\162s",array("\115MP_Rewr\151\164\145","\141dd_quer\171\137\166ars")); add_action("\164emplat\145\137\162edirect",array("\115\115\120_Rewrite","red\151\162\145ct_to_en\144\160\157int")); } public static function lmm_activate() { global $wp_version; if (version_compare($wp_version,"3.3","<")) { exit ("\133Maps Mar\153\145\162 Pro - \151\156\163tallatio\156\040\146ailed\041\135\072 Wor\144\120\162ess Ve\162\163\151on 3.\063\040or hig\150\145\162 is \156\145\145ded f\157\162\040this\040\160\154ugin\040\164\157 run\040\160\162oper\154\171\040(you\040\141re usi\156\147\040ver\163\151\157n ".$wp_version.") \055\040\160lease \165\160\147rade you\162\040\127ordPre\163\163\040instal\154\141\164ion!"); } if (version_compare(phpversion(),"5.2","\074")) { exit ("\133\115aps Mark\145\162\040Pro - i\156\163\164allatio\156\040\146ailed\135\072\040PHP 5\056\062\040or h\151\147\150er is\040\156\145eded \146\157\162 this\040\160lugin t\157\040run pro\160\145\162ly (\171\157\165 are \165\163\151ng PH\120\040".phpversion()."\051\040\055 pleas\145\040\143ontact\040\171\157ur hos\164\145\162 to up\147\162\141de you\162\040\120HP ins\164\141\154latio\156\041"); } mmp_rewrite::set_rewrite_rules(); flush_rewrite_rules(TRUE); } public static function lmm_deactivate() { wp_clear_scheduled_hook("\154\155\155_wp_se\163\163\151on_garb\141\147\145_collec\164\151\157n"); } function lmm_deregister_scripts() { global $wp_scripts; if ( isset ($wp_scripts->registered) && is_array($wp_scripts->registered)) { foreach ($wp_scripts->registered as $script) { if (strpos($script->src ,"\155aps.g\157\157\147le.com/m\141\160\163/api/js") !== FALSE) { wp_dequeue_script($script->handle); } if (strpos($script->src ,"ma\160\163\056google\141\160\151s.com/m\141\160\163/api/j\163") !== FALSE) { wp_dequeue_script($script->handle); } } } } function lmm_ajax_actions_backend() { include ("inc".DIRECTORY_SEPARATOR."ajax\055\141\143tions-\142\141\143kend.ph\160"); } function lmm_ajax_actions_frontend() { include ("\151\156c".DIRECTORY_SEPARATOR."\141jax-act\151\157\156s-front\145\156\144.php"); } function lmm_modify_post_mime_types($post_mime_types) { $post_mime_types["\141pplicati\157\156\057gpx+xm\154"]=array(__("\107\120X track","lmm"),__("\115anage G\120\130\040tracks","\154\155\155"),_n_noop("\107\120\130 track \074\163\160an cla\163\163\075\042cou\156\164\042>(%s)\074\057span>","GP\130\040\164racks <\163\160\141n class=\042\143\157unt\042\076\050%s)</sp\141\156\076","lmm")); return $post_mime_types; } function lmm_permit_mime_types_on_upload($mimes) { $mimes["\170ml"]="a\160\160\154ication\057\170\155l"; $mimes["gp\170"]="ap\160\154\151cation/\147\160\170+xml"; return $mimes; } function lmm_plugins_page_add_links($links,$file) { $plugin="\154\145aflet-m\141\160\163-marker\055\160\162o/leaf\154\145\164-maps-\155\141\162ker.ph\160"; $O4=get_option("leafl\145\164\155apsmarke\162\137\166ersion_\160\162\157"); if ($file == $plugin) { $l5="<a\040\163tyle=\042\164\145\170t-decor\141\164\151on:non\145\073\042 titl\145\075\042".esc_attr__("Ma\160\163\115arker a\146\146\151liate p\162\157\147ram - s\151\147\156 up no\167\040\141nd re\143\145\151ve com\155\151\163sion\163\040\165p to\040\0650%!","lmm")."\042 href=\042\150\164tps://af\146\151\154iates.m\141\160\163marker\056\143\157m/\042 \164\141\162get=\042\137\142lank\042\076\074img s\162\143\075\042".O1."\151\156\143/img/ico\156\055\141ffilia\164\145\163.png\042\040\167idth=\042\061\066\042 he\151\147\150t=\0421\066\042 alt=\042".esc_attr__("\115apsMarke\162\040\141ffilia\164\145\040progra\155\040\055 sig\156\040\165p now \141\156\144 recei\166\145\040commi\163\163\151ons u\160\040\164o 50%\041","\154\155\155")."\042></a>"; $O5="\074a style\075\042\164ext-de\143\157\162ation:n\157\156\145;\042 t\151\164\154e=\042".esc_attr__("Map\163\115\141rker re\163\145\154ler pr\157\147\162am - r\145\055\163ell wi\164\150\040a 20%\040\144\151scoun\164\041","l\155\155")."\042\040\150ref=\042\150\164\164ps://ww\167\056\155apsmar\153\145\162.com/re\163\145\154ler\042\040\164\141rget=\042\137\142lank\042\076\074img \163\162\143=\042".O1."i\156\143\057img/ico\156\055\162eselle\162\163\056png\042\040\167\151dth=\042\061\066\042 he\151\147\150t=\0421\066\042 alt=\042".esc_attr__("MapsMark\145\162\040reselle\162\040\160rogram \055\040re-sell \167\151\164h a 20\045\040discoun\164\041","lmm")."\042\076</a>"; $l6="\074a style=\042\164\145xt-dec\157\162\141tion:n\157\156\145;\042 \150\162\145f=\042ht\164\160\163://ww\167\056\155apsma\162\153\145r.co\155\057\162evie\167\163\042 targ\145\164\075\042_b\154\141\156\153\042 tit\154\145=\042".esc_attr__("\160\154ease ra\164\145\040this \160\154\165gin on\040\167\157rdpr\145\163\163.org","\154\155\155")."\042><img sr\143\075\042".O1."\151nc/img/\151\143\157n-star.\160\156\147\042 w\151\144\164h=\0421\066\042 height\075\042\0616\042 \141\154t=\042".esc_attr__("\160lease \162\141\164e this \160\154\165gin on\040\167\157rdpre\163\163\056org","lmm")."\042></a>"; $O6="<a \150\162\145f=\042ht\164\160\163://tran\163\154\141te.map\163\155\141rker.c\157\155\057projec\164\163\057lmm\042\040\164arget=\042\137\142lank\042\040\164itle=\042".esc_attr__("\164\162anslati\157\156\163","\154mm")."\042><img sr\143\075\042".O1."\151\156\143/img/i\143\157\156-transl\141\164\151ons.png\042\040\167idth=\042\061\066\042 he\151\147\150t=\042\061\066\042 alt\075\042".esc_attr__("trans\154\141\164ions","lmm")."\042\076</a>"; $l7="<a href=\042\150\164tps://\167\167\167.mapsmar\153\145\162.com/h\141\143\153erone\042\040\164arget=\042\137\142lank\042\040\164itle=\042".esc_attr__("Boun\164\171\040Hunters\040\167\141nted! \106\151\156d secur\151\164\171 bugs \164\157\040earn c\141\163\150 and l\151\143\145nses","lmm")."\042\076<img src\075\042".O1."\151\156c/img/ic\157\156\055hackero\156\145\056png\042\040\167\151dth=\042\061\066\042 he\151\147\150t=\0421\066\042\040alt=\042\150\141cker\157\156\145\042>\074\057\141>"; $O7="\074\141\040href=\042\150\164\164ps://\146\141\143ebook.c\157\155\057mapsm\141\162\153er\042 \164\141\162get=\042\137\142lank\042\040\164itle=\042".esc_attr__("\106\157\154low Maps\115\141\162ker on \106\141\143ebook","\154mm")."\042\076<img s\162\143\075\042".O1."inc/img/i\143\157\156-faceboo\153\056\160ng\042 \167\151\144th=\042\061\066\042 heig\150\164\075\04216\042\040\141lt=\042".esc_attr__("\106ollow Ma\160\163\115arker o\156\040\106aceboo\153","\154mm")."\042\076</a>"; $l8="\074a href\075\042\150ttps:/\057\164\167itter.\143\157\155/mapsm\141\162\153er\042 t\141\162\147et=\042\137\142\154ank\042\040\164\151tle=\042".esc_attr__("Foll\157\167\040@MapsMa\162\153\145r on Tw\151\164\164er","l\155\155")."\042\076\074img src\075\042".O1."\151\156\143/img/\151\143\157n-twitt\145\162\056png\042\040\167\151dth=\042\061\066\042 h\145\151\147ht=\042\061\066\042 alt\075\042".esc_attr__("Follow\040\100\115apsMark\145\162\040on Twit\164\145\162","\154\155\155")."\042\076</a>"; $O8="<a hre\146\075\042https:/\057\167\167w.maps\155\141\162ker.com\057\053\042 tar\147\145\164=\042_bl\141\156\153\042 t\151\164\154e=\042".esc_attr__("Follow\040\115\141psMarke\162\040\157n Goog\154\145\053","lm\155")."\042><im\147\040\163rc=\042".O1."inc/im\147\057\151con-goo\147\154\145-plus.p\156\147\042 width\075\042\0616\042 \150\145\151ght=\042\061\066\042 al\164\075\042".esc_attr__("\106\157\154low Maps\115\141\162ker on\040\107\157ogle+","\154\155m")."\042\076</a>"; $l9="<a h\162\145\146=\042htt\160\163\072//feeds\056\146\145edburn\145\162\056com/Ma\160\163\115arker\042\040\164arget=\042\137\142lank\042\040\164itle=\042\122\123S\042>\074\151\155g sr\143\075\042".O1."\151\156\143/img/ico\156\055\162ss.png\042\040\167idth=\042\061\066\042 h\145\151\147ht=\042\061\066\042 alt=\042\162\163s\042>\074\057a>"; $O9="\074\141\040href=\042\150\164tp://fee\144\142\165rner.go\157\147\154e.com/f\142\057\141/mail\166\145\162ify?ur\151\075\115apsM\141\162\153er\042\040\164\141rget=\042\137\142lank\042\040\164itle\075\042\122SS (\166\151\141 Emai\154\051\042><im\147\040src=\042".O1."\151nc/img\057\151\143on-rss-\145\155\141il.png\042\040\167idth=\042\061\066\042 he\151\147\150t=\042\061\066\042 alt=\042\162\163s-em\141\151\154\042><\057\141>"; if ((la($Oa=FALSE,$lb=TRUE) === TRUE) && (la() === FALSE)) { $Ob="\074br/></td\076\074\057tr><tr\076\074\164d cols\160\141\156=\0423\042\040\163tyle=\042\142\157rder-b\157\164\164om:1px\040\163olid #\143\143\143;padd\151\156\147:0;\042\076\074div s\164\171\154e=\042\160\141\144ding\072\040\063px 5\160\170\073back\147\162ound-c\157\154\157r: #\106\106\105BE8;b\157\162\144er: \061\160x soli\144\040\043CC00\060\060;colo\162\072 #333;\042\076<stron\147\076".__("Warning: \171\157\165r acces\163\040\164o upda\164\145\163 and s\165\160\160ort for\040\115\141ps Ma\162\153\145r Pro\040\150\141s exp\151\162\145d!","lmm")."\074\057strong>\074\142\162/>"; $lc=get_option("leaf\154\145\164mapsmar\153\145\162_versio\156\137\160ro_lat\145\163\164"); if (($lc != NULL) && ($lc>$O4)) { $Ob.=__("\114\141\164est av\141\151\154able v\145\162\163ion:","lmm")." <a hr\145\146\075'https\072\057/www.ma\160\163\155arker.\143\157\155/v4.0'\040\164\141rget=\047\137\142lank\047\040title='".esc_attr__("\143lick to s\150\157\167 relea\163\145\040notes","lmm")."'>4.0</a>\040"."\050<a href\075\047\167ww.map\163\155\141rker.c\157\155\057chang\145\154\157g/pro/\047\040target=\047\137blank'>".__("\163\150\157w all \141\166\141ilable \143\150\141ngelog\163","l\155\155")."\074\057\141>)<br/\076"; } $Ob.=sprintf(__("\131\157\165 can co\156\164\151nue usi\156\147\040versio\156\040%s with\157\165\164 any li\155\151\164ation\163\056\040Neve\162\164\150eless\040\171\157u wi\154\154\040not \142\145\040able \164\157\040get \165\160\144ates \151\156\143ludi\156\147\040bugf\151\170es, ne\167\040featur\145\163\040and \157\160\164imiza\164\151\157ns \141\163\040well\040\141s acce\163\163\040to \157\165\162 sup\160\157\162t sy\163\164em. ","lmm"),$O4)."<br/>".sprintf(__("<\141\040\150ref=\042\045\163\042>Plea\163\145\040renew \171\157\165r acc\145\163\163 to up\144\141\164es and\040\163\165pport\040\164o keep\040\171our pl\165\147\151n up-\164\157\055date\040\141\156d saf\145\074/a>.","lm\155"),l1."adm\151\156\056php?pag\145\075\154eaflet\155\141\160smarke\162\137\154icense")."</div\076"; } else { $Oc=WP_PLUGIN_DIR.DIRECTORY_SEPARATOR."\155\141ps-mark\145\162\055\160\162o".DIRECTORY_SEPARATOR."\162\145\141dme.tx\164"; if (!file_exists($Oc)) { $Ob="<br/\076\074\057td></tr><\164\162\076<td c\157\154\163pan=\042\063\042 style\075\042\142order\055\142\157ttom\072\061px sol\151\144\040#ccc\073\160\141ddin\147\072\060;\042\076\074div style\075\042paddi\156\147\072\0403px 5\160\170\073bac\153\147\162ound\055\143olor:\040\043ffff00\073\142order\072 \061\160x sol\151\144\040#000\060\0600;col\157\162\072 #33\063\073\042><\163\164\162ong>".__("\124\157 start\040\164\150e upd\141\164\145 to Ma\160\163\040Mar\153\145\162 Pro \166\064\0560 yo\165\162\040actio\156\040is nee\144\145d!","lmm")."</str\157\156\147> <a hr\145\146\075\042".l1."\141\144min.ph\160\077\160age=l\145\141\146letmaps\155\141\162ker_up\144\141\164e_mmp\064\042\076".__("Please\040\143\154ick he\162\145\040for m\157\162\145 infor\155\141\164ion","lmm")."</a>"; } else { $ld=get_plugin_data(WP_PLUGIN_DIR.DIRECTORY_SEPARATOR."maps\055\155\141rker-\160\162\157".DIRECTORY_SEPARATOR."\155\141ps-mark\145\162\055pro.p\150\160"); $Ob="<br/></\164\144\076</tr><t\162\076\074td c\157\154\163pan=\042\063\042 style=\042\142\157rder-\142\157\164\164om:1px\040s\157\154\151d #c\143\143\073padd\151\156\147:0;\042\076\074div\040\163\164yle=\042\160\141ddin\147\072\0403px\040\065px;bac\153\147\162ound\055\143olor: \043\146fff00;\142\157\162der:\040\061px sol\151\144\040#00\060\06000;col\157\162\072 #3\063\063;\042><\163\164rong>".sprintf(__("To f\151\156\151sh the\040\165\160date,\040\160\154ease f\151\162\163t dea\143\164\151vate \042\115\141ps Mar\153\145\162 Pro\042\040Versio\156\0403.1.1 \141\156\144 then\040\141ctivat\145\040\042Ma\160\163\040Mark\145\162\040Pro\042\040\126ersi\157\156\040%s","lmm"),$ld["\126ersion"])."\074/stron\147\076"; } } $links[]=$l5."&nbs\160\073".$O5."&nbsp;".$l6."&nbsp;".$O6."&nb\163\160\073".$l7."\046nbsp;".$O7."&nbsp;".$l8."&nbsp;".$O8."&nbsp\073".$l9."\046\156bsp;".$O9.$Ob; } return $links; } function lmm_delete_multisite_blog($blog_id) { switch_to_blog($blog_id); $GLOBALS["wpdb"]->query("\104ROP TAB\114\105\040`".$GLOBALS["wpdb"]->prefix."\154\145afletma\160\163\155arker_l\141\171\145rs`"); $GLOBALS["wpdb"]->query("DROP TAB\114\105\040`".$GLOBALS["\167\160\144b"]->prefix."leaflet\155\141\160smarker\137\155\141rkers`"); $l0=wp_upload_dir(); $icons_directory=$l0["\142\141\163edir"].DIRECTORY_SEPARATOR."leafl\145\164\055maps-m\141\162\153er-ico\156\163".DIRECTORY_SEPARATOR; if (is_dir($icons_directory)) { foreach (glob($icons_directory."*.*") as $v) { unlink($v); } rmdir($icons_directory); } } function lmm_update_pointer_admin_scripts() { $page=( isset ($_GET["pa\147\145"]) ? $_GET["page"]: ""); if ($page != "leaflet\155\141\160smarker\137\165\160date_\155\155\1604") { $dismissed_pointers=explode(",",( string) get_user_meta(get_current_user_id(),"dismiss\145\144\137wp_poi\156\164\145rs",TRUE)); $dismissed_pointers=array_flip($dismissed_pointers); $Od=FALSE; $lmm_version_new=get_option("\154eaflet\155\141\160smarker\137\166\145rsion_p\162\157"); $le="\154mmvp".str_replace("\056","",$lmm_version_new); if (! isset ($dismissed_pointers[$le])) { $current_dismissed_wp_pointers=get_user_meta(get_current_user_id(),"\144ismis\163\145\144_wp_poi\156\164\145rs"); $replace_lmmv=preg_replace("/(lmmv\050\160\051?(\134\144\051\053(,)?)/",NULL,$current_dismissed_wp_pointers["0"]); $replace_without_end_comma=preg_replace("/(,)\044\057",NULL,$replace_lmmv); update_user_meta(get_current_user_id(),"dism\151\163\163ed_wp_p\157\151\156ters",$replace_without_end_comma); $Od=TRUE; add_action("\141\144min_prin\164\137\146ooter_\163\143\162ipts",array($this,"\154\155m_updat\145\137\160ointer\137\146\157oter_sc\162\151\160t")); } if ($Od) { wp_enqueue_script("\167\160\055pointe\162"); wp_enqueue_style("\167\160-pointer"); } } } function lmm_update_pointer_footer_script() { $l4=get_option("\154\145afletmap\163\155\141rker_\157\160\164ions"); $lmm_version_new=get_option("leafle\164\155\141psmarke\162\137\166ersion_\160\162\157"); $le="lmmv\160".str_replace(".","",$lmm_version_new); $Oe="<h3>".esc_attr__("Maps \115\141\162ker Pro\040\055 action\040\156\145eded!","lmm")."</h3>"; $Oe.="\074\160\076".esc_attr__("To star\164\040\164he upd\141\164\145 to Map\163\040Marker \120\162\157 v4.0 \171\157\165r acti\157\156\040is n\145\145\144ed!","lmm")."\074br/><a\040\150\162ef=\042".l1."\141\144min.php?\160\141\147e=leaf\154\145\164mapsma\162\153\145r_upda\164\145\137mmp4\042\076".__("\120\154\145ase cl\151\143\153 here \146\157\162 more \151\156\146ormati\157\156","lmm")."\074/a></p>"; ?><?php echo "\012\011\011\074script \164\171\160e=\042t\145\170\164/javas\143\162\151pt\042\076\057/ <![CD\101\124\101[\012\011\011\152Query\050\144ocume\156\164\051.read\171\050functi\157\156\050\044)\040\173\012\011\011\011\151f(ty\160\145\157f(jQ\165\145\162y().p\157\151\156ter)\040\041= 'und\145\146ined')\040\173\012\011\011\011\011\044\050\047#tople\166\145l_page\137\154eaflet\155\141psmar\153\145\162_mar\153\145rs').p\157\151nter(\173\012\011\011\011\011\011con\164\145nt: '"; ?><?php echo $Oe; ?><?php echo "',\012\011\011\011\011\011p\157\163\151tion: \173\012\011\011\011\011\011\011edge\072\040\047left\047\054\012\011\011\011\011\011\011\141\154ign: '\143\145\156ter'\012\011\011\011\011\011\175,\012\011\011\011\011\011\143\154ose: f\165\156\143tion\050\051 \173\012\011\011\011\011\011\011\044.po\163\164( ajax\165\162\154, \173\012\011\011\011\011\011\011\011\160\157inter:\040\047"; ?><?php echo $le; ?><?php echo "',\012\011\011\011\011\011\011\011actio\156\072\040'dism\151\163\163-wp-p\157\151\156ter'\012\011\011\011\011\011\011});\012\011\011\011\011\011\175\012\011\011\011\011\175).po\151\156\164er('\157\160\145n');\012\011\011\011}\012\011\011});\012\011\011// ]\135\076</scri\160\164\076\012\011\011"; ?><?php } function lmm_feature_pointer_admin_scripts() { $dismissed_pointers=explode(",",( string) get_user_meta(get_current_user_id(),"d\151\163\155issed_w\160\137\160ointer\163",TRUE)); $dismissed_pointers=array_flip($dismissed_pointers); $Od=FALSE; if (! isset ($dismissed_pointers["lmm\145\163\167"])) { $Od=TRUE; add_action("adm\151\156_print\137\146\157oter\137\163\143ripts",array($this,"lmm_fea\164\165\162e_poin\164\145\162_foot\145\162\137scrip\164")); } if ($Od) { wp_enqueue_script("\167\160-pointer"); wp_enqueue_style("wp-p\157\151\156ter"); } } function lmm_feature_pointer_footer_script() { include ("\151nc".DIRECTORY_SEPARATOR."\146eature\055\160\157inter\163\056\160hp"); } function lmm_register_widgets() { $l4=get_option("leaflet\155\141\160smarke\162\137\157ptions"); if ($l4["mi\163\143\137whitela\142\145\154\137ba\143\153\145nd"] == "en\141\142\154ed") { $lf=__("M\141\160\163 - rec\145\156\164 marker\163","lmm"); } else { $lf=__("\115aps Mark\145\162\040Pro -\040\162\145cent m\141\162\153ers","lmm"); } wp_add_dashboard_widget("\154\155m-admin\055\144ashboar\144\055widget",$lf,array(&$this,"lm\155\137\144ashboar\144\137\167idget"),array(&$this,"\154\155\155_dashbo\141\162\144_widget\137\143\157ntrol")); } function lmm_dashboard_widget() { global $wpdb; $l4=get_option("leafletm\141\160\163marker\137\157\160tions"); if ($l4["\144\145faults_\155\141\162ker_cu\163\164\157m_icon_\165\162\154_dir"] == "\156o") { $defaults_marker_icon_dir=l3; $defaults_marker_icon_url=O2; } else { $defaults_marker_icon_dir=htmlspecialchars($l4["de\146\141ults_ma\162\153er_icon\137\144ir"]); $defaults_marker_icon_url=esc_url($l4["d\145\146\141ults_ma\162\153\145r_icon\137\165\162l"]); } $table_name_markers=$wpdb->prefix."leafle\164\155\141psmark\145\162\137marker\163"; $widgets=get_option("\144ashboar\144\137\167idget_o\160\164\151ons"); $widget_id="\154\155\155-admin\055\144ashboar\144\055\167idget"; $number_of_markers= isset ($widgets[$widget_id]) && isset ($widgets[$widget_id]["items"]) ? absint($widgets[$widget_id]["\151\164ems"]): 4; if ((la($Oa=FALSE,$lb=TRUE) === TRUE) && (la() === FALSE)) { $O4=get_option("leafle\164\155\141psmark\145\162\137versio\156\137\160ro"); echo "\074div styl\145\075\042padd\151\156\147: 3px \065\160\170;bac\153\147\162ound-\143\157\154or: #\106\106\105BE8;b\157\162\144er:\040\061px so\154\151d #CC0\060\0600;bord\145\162\055radi\165\163\072 3px\073\143olor: \043\06333;\042\076\074stron\147\076".__("\127\141rning: \171\157\165r acc\145\163\163 to up\144\141\164es and\040\163\165pport\040\146\157r Map\163\040\115arker\040\120ro has\040\145\170pire\144\041","lmm")."</str\157\156\147><br/>"; $lc=get_option("\154\145\141fletma\160\163\155arker_v\145\162\163ion_pr\157\137\154atest"); if (($lc != NULL) && ($lc>$O4)) { echo __("Lates\164\040\141vaila\142\154\145 versi\157\156\072","\154\155m")."\040<a href=\047\150\164tps://\167\167\167.mapsma\162\153\145r.com/\166\064\0560' ta\162\147\145t='_b\154\141\156k' ti\164\154\145='".esc_attr__("click t\157\040\163how re\154\145\141se not\145\163","\154\155\155")."\047>4.0</a\076\040"."(<a hr\145\146\075'http\163\072\057/www.\155\141\160smarke\162\056\143om/ch\141\156\147elog/p\162\157\057' tar\147\145\164='_b\154\141\156k'>".__("show all\040\141\166ailabl\145\040\143hangel\157\147\163","\154\155\155")."\074/a>)<br\057\076"; } echo sprintf(__("You \143\141\156 contin\165\145\040using\040\166\145rsion \045\163 withou\164\040\141ny li\155\151\164ations\056\040Nevert\150\145\154ess \171\157\165 will\040\156ot be \141\142\154e to \147\145\164 upda\164\145\163 incl\165\144\151ng b\165\147\146ixes\054\040new fe\141\164ures a\156\144\040opt\151\155\151zatio\156\163 as we\154\154\040as a\143\143ess to\040\157ur sup\160\157rt sys\164\145m. ","\154\155\155"),$O4)."<br/\076".sprintf(__("\074a href=\042\045\163\042>Pl\145\141\163e ren\145\167\040your \141\143\143ess to\040\165\160dates\040\141nd supp\157\162\164 to k\145\145p your \160\154\165gin \165\160\055to-d\141\164\145 and \163\141\146e</a>\056","lmm"),l1."admin.\160\150\160?page=l\145\141\146letmap\163\155\141rker_li\143\145\156se")."</div\076"; echo "<hr styl\145\075\042border\072\060\073heig\150\164\0721px;b\141\143\153ground\055\143\157lor:#\144\070\1448d8;\042\057\076"; } else { if (current_user_can("activat\145\137\160lugins")) { $Oc=WP_PLUGIN_DIR.DIRECTORY_SEPARATOR."ma\160\163\055marker\055\160\162o".DIRECTORY_SEPARATOR."\162\145\141dme.tx\164"; if (!file_exists($Oc)) { echo "<p><a \163\164\171le=\042\142\141\143kgroun\144\072\043f997\065\065;displ\141\171\072block\073\160\141dding\072\064px;tex\164\055\144ecor\141\164\151on:n\157\156\145;colo\162\072\0432702\143\066;text-\141\154\151gn:ce\156\164\145r;\042\040\150ref=\042".LEAFLET_WP_ADMIN_URL."admin.p\150\160\077page=l\145\141\146letmap\163\155\141rker_u\160\144\141te_mm\160\064\042>".esc_attr__("\124\157\040start\040\164\150e upda\164\145\040to Map\163\040\115arker\040\120\162o v4.\060\040your ac\164\151\157n is \156\145\145ded!","\154mm")."\074br/>".__("\120lease cl\151\143\153 here \146\157\162 more i\156\146\157rmati\157\156","\154\155\155")."\074\057a><hr \163\164yle=\042\142\157\162der:0;\150\145\151ght:1\160\170\073backg\162\157\165nd-col\157\162\072#d8d\070\144\070;\042\057\076</p>"; } else { $ld=get_plugin_data(WP_PLUGIN_DIR.DIRECTORY_SEPARATOR."maps-m\141\162\153er-pro".DIRECTORY_SEPARATOR."\155aps-marke\162\055\160ro.ph\160"); echo "<p><spa\156\040\163tyle=\042\142\141ckground\072\043\14699755\073\144\151splay\072\142\154ock;pa\144\144\151ng:4p\170\073\164ext-\144\145\143orati\157\156\072none\073\143\157lor:\043\062702c6;\164\145\170t-al\151\147\156:cent\145\162\073\042>".sprintf(__("To\040\146\151nish t\150\145\040update\054\040\160lease\040\146\151rst d\145\141\143tivat\145\040\042Maps \115\141\162ker P\162\157\042 Ver\163\151\157n 3.\061\0561 and \164\150\145n act\151\166\141te \042\115\141ps Mar\153\145\162 Pro\042\040\126ersi\157\156\040%s","lmm"),$ld["\126ersion"])."\074/span>\074\150\162 style=\042\142\157rder:0\073\150\145ight:\061\160\170;back\147\162\157und-co\154\157\162:#d8d\070\1448;\042/\076\074/p>"; } } } $Of=$wpdb->get_results($wpdb->prepare( "\123\105LECT `i\144\140\054`marke\162\156\141me`,`i\143\157\156`,`cre\141\164\145don`,`\143\162\145atedby\140\040\106ROM \140$table_name_markers` O\122\104\105R BY `c\162\145\141tedon` \144\145\163c LIMI\124\040%d" ,$number_of_markers),ARRAY_A); if ($Of != NULL) { echo "<table \163\164\171le=\042\155\141\162gin-bot\164\157\155:5px;\042\076\074tr>"; foreach ($Of as $row) { $icon=($row["icon"] == NULL) ? O1."l\145\141\146let-di\163\164\057images\057\155\141rker.p\156\147": $defaults_marker_icon_url."\057".esc_html($row["icon"]); echo "<td>\074\141\040href\075\042".l1."\141dmin.p\150\160\077page=l\145\141\146letmap\163\155\141rker_\155\141\162ker&i\144\075".$row["id"]."\042 ti\164\154\145=\042".esc_attr__("\145\144it marke\162","\154mm")."\042><img src\075\042".$icon."\042 w\151\144\164h=\042".intval($l4["def\141\165\154ts_mar\153\145\162_icon_\151\143\157nsize_\170"])."\042\040\150\145ight=\042".intval($l4["\144\145\146aults_\155\141\162ker_ic\157\156\137iconsiz\145\137y"])."\042\076\074/a>"; echo "<td styl\145\075\042verti\143\141\154-align:\164\157\160;line-\150\145\151ght:1.\062\145\155;\042>"; echo "\074a href=\042".l1."\141\144min.ph\160\077\160age=l\145\141\146letmaps\155\141\162ker_ma\162\153\145r&id=".$row["\151\144"]."\042 title=\042".esc_attr__("\145dit marke\162","\154mm")."\042\076".htmlspecialchars(stripslashes($row["ma\162\153ername"]))."\074\057a><br/\076".__("\143reated\040\157\156","\154\155\155")."\040".date("\131-m-d - h\072\155",strtotime($row["c\162\145\141tedon"]))."\054 ".__("cr\145\141\164ed by","lm\155")." ".esc_html($row["cr\145\141\164edby"]); echo "\074\057\164d></t\162\076"; } echo "\074\057table>"; } else { echo "\074p style\075\042margin-b\157\164\164om:5p\170\073\042>".__("\116\157\040marke\162\040\143reate\144\040\171et","\154\155m")."</p>"; } if (! isset ($widgets[$widget_id]["\142\154\157gposts"])) { $lg=1; } else if ( isset ($widgets[$widget_id]["blogpo\163\164\163"]) && ($widgets[$widget_id]["blog\160\157\163ts"] == 1)) { $lg=0; } else { $lg=1; } function lmm_spc_custom_name($Og) { return "\155apsmark\145\162\055dash\142\157ard-wid\147\145t-rss-\151\164\145m-ca\143\150\145"; } if (($lg == 1) && ($l4["\155\151sc_whit\145\154\141bel_b\141\143\153end"] == "\144\151\163abled")) { require_once (ABSPATH.WPINC.DIRECTORY_SEPARATOR."cl\141\163\163-simpl\145\160\151e.php"); $lh=new simplepie(); if (file_exists($defaults_marker_icon_dir.DIRECTORY_SEPARATOR."re\141\144\155e-icons\056\164xt")) { $lh->enable_cache(TRUE); $lh->set_cache_location($location=$defaults_marker_icon_dir); $lh->set_cache_name_function("\154mm\137\163\160c_cust\157\155\137name"); $lh->set_cache_duration(0250600); } else { $lh->enable_cache(FALSE); } $lh->set_feed_url("ht\164\160\072//fe\145\144\163.feed\142\165\162ner.co\155\057\115apsMa\162\153\145rPro"); $lh->set_stupidly_fast(TRUE); $lh->enable_order_by_date(TRUE); $lh->init(); $lh->handle_content_type(); echo "\074\150\162 style\075\042border:\060\073\150eight\072\061\160x;bac\153\147\162ound-\143\157\154or:#d8\144\070d8;\042/\076\074p styl\145\075\042mar\147\151\156:0.5e\155\0400;font-\167\145\151ght:\142\157\154d;\042\076".__("Latest \142\154\157g posts\040\146\162om www\056\155\141psmar\153\145\162.com","lm\155")."<\057\160\076"; if ($lh->get_items() == NULL) { $blogpost_url="<a href\075\042https:/\057\167\167w.maps\155\141\162ker.co\155\057news\042\040\164\141rget=\042\137\142lank\042\076\150ttps\072\057/www.\155\141\160smark\145\162\056com/\156\145\167s</a>"; echo sprintf(__("\106\145\145d could\040\156\157t be \162\145\164rieved,\040\160lease t\162\171\040again \154\141\164er or\040\162ead th\145\040lates\164\040blog p\157\163ts at \045\163","lmm"),$blogpost_url); } foreach ($lh->get_items(0,3) as $item) { echo "<p style\075\042margin:0\056\065em 0;\042\076".$item->get_date("\152 F Y").": <a h\162\145\146=\042".$item->get_permalink()."\077ref=d\141\163\150board\042\076".str_replace("\144iv>","span>",$item->get_title())."</a\076\074/p>".PHP_EOL; } echo "<hr sty\154e=\042\142\157rder:0\073\150\145ight:1\160\170\073backg\162\157\165nd-co\154\157\162:#d8d\070\1448;\042/>\012\011\011\011\011\074div st\171\154\145=\042\144\151\163play:\151\156\154ine-\142\154\157ck;\042\076\074a st\171\154\145=\042t\145\170t-d\145\143orati\157\156:none;\042\040href=\042\150\164tps:\057\057www.ma\160\163marker\056\143om\042 \164\141rget=\042\137\142lank\042\076<img \163\162\143=\042".O1."\151\156\143/img/ico\156\055\167ebsite\055\150\157me.pn\147\042\040widt\150\075\04216\042\040\150\145ight=\042\061\066\042 \141\154t=\042ma\160\163marker\056\143\157m\042>\040\115apsMar\153\145\162.com<\057\141></div\076\046nbsp;\012\011\011\011\011\074\144iv sty\154\145=\042di\163\160\154ay:i\156\154\151ne-b\154\157\143k;\042\076\074a sty\154\145\075\042\164\145\170t-de\143\157ration\072\156one;\042\040\164itle\075\042".esc_attr__("Map\163\115\141rker af\146\151\154iate p\162\157\147ram - \163\151\147n up \156\157\167 and r\145\143\145ive c\157\155\155issi\157\156\163 up t\157\040\0650%!","\154mm")."\042\040\150\162ef=\042\150\164\164ps://a\146\146\151liates.\155\141\160smark\145\162\056com/\042\040\164arget=\042\137\142lank\042\076<img s\162\143\075\042".O1."inc/img/i\143\157\156-affil\151\141\164es.png\042\040\167idth=\042\061\066\042 \150\145\151ght=\042\061\066\042 al\164\075\042".esc_attr__("\115\141\160sMarke\162\040\141ffilia\164\145\040progra\155\040\055 sig\156\040\165p now \141\156\144 rece\151\166\145 comm\151\163\163ions\040\165\160 to \065\060%!","\154mm")."\042> ".__("\101ffilia\164\145\163","lmm")."<\057\141\076</div>\046\156\142sp;\012\011\011\011\011<di\166\040\163tyle\075\042\144ispla\171\072\151nline\055\142lock;\042\076\074a st\171\154\145=\042t\145\170t-deco\162\141\164ion:n\157\156\145;\042 \164\151\164le=\042".esc_attr__("MapsMark\145\162\040resell\145\162\040progr\141\155\040- re-\163\145\154l with\040\141\04020% \144\151\163count\041","\154\155m")."\042 h\162\145\146=\042htt\160\163\072//www.\155\141\160smarke\162\056\143om/re\163\145\154ler\042\040\164\141rget=\042\137blank\042\076\074img \163\162\143=\042".O1."\151nc/img/\151\143\157n-resel\154\145\162s.png\042\040\167idth=\042\061\066\042 h\145\151\147ht=\042\061\066\042 al\164\075\042".esc_attr__("Maps\115\141\162ker res\145\154\154er prog\162\141\155 - re-\163\145\154l with\040\141\04020% d\151\163\143ount!","lmm")."\042\076\040".__("\122\145\163ellers","l\155\155")."\074/a></di\166\076\046nbsp;\012\011\011\011\011<d\151\166\040style\075\042display\072\151\156line-\142\154\157ck;\042\076\074a st\171\154\145=\042\164\145\170t-dec\157\162\141tion:\156\157\156e;\042\040\150ref=\042\150\164tps://\167\167\167.map\163\155\141rker\056\143\157m/re\166\151ews\042\040\164\141rget\075\042_blan\153\042\040tit\154\145\075\042".esc_attr__("\160lease r\141\164\145 this p\154\165\147in on\040\167\157rdpr\145\163\163.org","\154\155\155")."\042><\151\155\147 src=\042".O1."\151nc/img/i\143\157\156-star.\160\156\147\042 wi\144\164\150=\0421\066\042\040heig\150\164\075\04216\042\040\141lt=\042".esc_attr__("pl\145\141\163e rate \164\150\151s plug\151\156\040on wor\144\160\162ess.o\162\147","lmm")."\042> ".__("\162\141te plugi\156","\154\155m")."</a></di\166\076\046nbsp;\012\011\011\011\011<\144\151\166 styl\145\075\042displ\141\171\072inli\156\145\055block\073\042><a h\162\145\146=\042h\164\164\160s://\164\162\141nslat\145\056mapsma\162\153\145r.com\057\160roject\163\057lmm\042\040\164\141rget\075\042_blank\042\076<img \163\162\143=\042".O1."inc/img/\151\143\157n-trans\154\141\164ions.png\042\040\167\151dth=\042\061\066\042 hei\147\150\164=\04216\042\040\141lt=\042\164\162anslat\151\157\156s\042>\040".__("tran\163\154\141tions","lmm")."</a></\144\151\166>&nbsp;\012\011\011\011\011<di\166\040\163tyle=\042\144\151splay:i\156\154\151ne-blo\143\153\073\042><\141\040href=\042\150\164tps://\167\167\167.mapsm\141\162\153er.co\155\057\150acke\162\157\156e\042 \164\141\162get=\042\137\142lank\042\040\164itle=\042".esc_attr__("\102\157\165nty Hu\156\164\145rs wan\164\145\144! Find s\145\143\165rity \142\165\147s to e\141\162\156 cash\040\141\156d lic\145\156\163es","lmm")."\042\076<img src\075\042".O1."\151nc/img\057\151\143on-hack\145\162\157ne.png\042\040\167idth=\042\061\066\042 he\151\147\150t=\0421\066\042\040alt=\042\150\141cker\157\156\145\042> \150\141\143keron\145\074\057a></\144\151\166>&nbs\160\073\012\011\011\011\011<div s\164\171\154e=\042\144\151\163play\072\151nline-\142\154\157ck;\042\076\074a hre\146\075\042htt\160\163\072//tw\151\164ter.co\155\057mapsma\162\153\145r\042\040\164arget=\042\137blank\042\076<img \163\162c=\042".O1."inc/i\155\147\057icon-tw\151\164\164er.png\042\040\167idth=\042\061\066\042 he\151\147\150t=\042\061\066\042 alt=\042\164\167itte\162\042> Twitt\145\162\074/a><\057\144\151v>&n\142s\160\073\012\011\011\011\011<div \163\164\171le=\042\144\151splay:\151\156line-b\154\157\143k;\042\076\074a hre\146\075\042htt\160\163\072//fa\143\145book.c\157\155\057map\163\155arker\042\040\164arge\164\075\042_bl\141\156k\042><\151\155g src\075\042".O1."inc/img\057\151\143\157n-facebo\157\153\056png\042\040\167\151dth=\042\061\066\042 he\151\147\150t=\042\061\066\042 alt\075\042\146aceb\157\157\153\042> \106\141\143ebook\074\057a></di\166\076\046nbsp\073\012\011\011\011\011\074div st\171\154\145=\042d\151\163\160lay:\151\156\154ine-b\154\157\143k;\042\076\074a hre\146\075\042htt\160\163\072//ww\167\056mapsma\162\153\145r.co\155\057+\042 t\141\162\147et=\042\137\142lank\042\076<img \163\162\143=\042".O1."inc/\151\155\147/icon-g\157\157\147le-plus.\160\156\147\042 wi\144\164\150=\0421\066\042\040heigh\164\075\04216\042\040\141lt=\042g\157\157\147le+\042\076\040Goog\154\145\053</a><\057\144iv>&nbs\160\073\012\011\011\011\011<div s\164\171\154e=\042\144\151splay:\151\156\154ine-\142\154\157ck;\042\076\074a sty\154\145\075\042t\145\170\164-dec\157\162\141tion\072\156\157ne;\042\040\150ref=\042\150ttps:\057\057www.ma\160\163marker\056\143om/ch\141\156\147elog\057\160ro\042\040\164arget\075\042_blan\153\042><img\040\163rc=\042".O1."\151\156c/img/ic\157\156\055change\154\157\147-header\056\160\156g\042 \167\151\144th=\042\061\066\042 heig\150\164\075\0421\066\042 alt=\042\143\150angelo\147\042\076 ".__("\103\150angelog","lm\155")."</a\076\074\057div>&\156\142\163p;\012\011\011\011\011<div s\164\171\154e=\042\144\151\163play:in\154\151\156e-blo\143\153\073\042><\141\040\150ref=\042\150\164tps:/\057\146\145eds.\146\145\145dburn\145\162\056com/\115\141\160sMark\145\162\042 targ\145\164\075\042_\142\154\141nk\042\076\074img sr\143\075\042".O1."in\143\057\151mg/ico\156\055\162ss.png\042\040\167idth=\042\061\066\042 h\145\151\147ht=\042\061\066\042 alt=\042\162ss\042> \122\123\123</a><\057\144iv>&nb\163\160\073\012\011\011\011\011<div \163\164\171le=\042\144\151splay\072\151\156line-\142\154\157ck;\042\076\074a hre\146\075\042htt\160\072\057/fe\145\144\142urner\056\147oogle.\143\157\155/fb/\141\057mailve\162\151\146y?ur\151\075MapsMa\162\153\145r\042\040\164arget\075\042_blank\042\076<img \163\162c=\042".O1."\151\156\143/img/ic\157\156\055rss-ema\151\154\056png\042\040\167\151dth=\042\061\066\042 hei\147\150\164=\04216\042\040alt=\042\162\163\163-ema\151\154\042> ".__("\105\055\115ail","lmm")."</a></di\166\076"; } } function lmm_dashboard_widget_control() { $l4=get_option("leafl\145\164\155apsmark\145\162\137options"); $widget_id="\154\155\155-admin-\144\141\163hboard-\167\151\144get"; $form_id="\154\155m-admin-\144\141\163hboard-\167\151\144get-con\164\162\157l"; $update=FALSE; if (!$widget_options=get_option("dashb\157\141\162d_widge\164\137\157ptions")) $widget_options=array(); if (! isset ($widget_options[$widget_id])) { $widget_options[$widget_id]=array("\142\154ogposts" => 0,"\151\164ems" => 5); $update=TRUE; } if ("\120OST" == $_SERVER["\122\105\121UEST_ME\124\110\117D"] && isset ($_POST[$form_id])) { $number=($_POST[$form_id]["\151\164\145ms"] == NULL) ? "3": absint($_POST[$form_id]["items"]); $Oh= isset ($_POST[$form_id]["\142\154ogposts"]) ? "\061": "\060"; $widget_options[$widget_id]["\151\164\145ms"]=$number; $widget_options[$widget_id]["\142logpos\164\163"]=$Oh; $update=TRUE; } if ($update) update_option("das\150\142\157ard_wid\147\145\164_option\163",$widget_options); $number= isset ($widget_options[$widget_id]["\151\164\145ms"]) ? ( integer) $widget_options[$widget_id]["items"]: ""; echo "\074\160><label\040\146\157r=\042l\155\155\055admin-\144\141\163hboard\055\167\151dget-\156\165\155ber\042\076".__("Number\040\157\146 marke\162\163\040to sho\167\072")." </la\142\145\154>"; echo "<i\156\160\165t id=\042\154\155\155-admin-\144\141\163hboard-\167\151\144get-nu\155\142\145r\042 n\141\155\145=\042".$form_id."\133items]\042\040\164ype=\042\164\145\170t\042 va\154\165\145=\042".$number."\042 size=\042\062\042 /></p\076"; if ($l4["\155\151\163c_whit\145\154\141bel_back\145\156\144"] == "disabled") { echo "<p>\074\154\141bel fo\162\075\042lmm-adm\151\156\055dashbo\141\162\144-widge\164\055\142logpo\163\164\163\042>".__("\110\151de blog\040\160\157sts an\144\040\154ink sec\164\151\157n:")."\040\074/label\076"; echo "<inpu\164\040\151d=\042l\155\155\055admin-d\141\163\150board-w\151\144\147et-bl\157\147\160osts\042\040\156ame=\042".$form_id."[blogpos\164\163\135\042 ty\160\145\075\042che\143\153\142ox\042 ".checked($widget_options[$widget_id]["blo\147\160\157sts"],1,FALSE)."\057\076</p>"; } } function lmm_load_translation_files() { load_plugin_textdomain("lmm",FALSE,dirname(plugin_basename( __FILE__))."/language\163\057"); } function lmm_set_plugin_locale($lang) { $l4=get_option("leafletm\141\160\163marker_\157\160\164ions"); global $locale; if ($l4["mis\143\137\160lugin_l\141\156\147uage_ar\145\141"] == "\142\141ckend") { return is_admin() ? $l4["misc_plu\147\151\156_languag\145"]: $locale; } else if ($l4["\155isc_plugi\156\137\154anguage\137\141\162ea"] == "\146ronten\144") { return is_admin() ? $locale: $l4["\155\151sc_plug\151\156\137langua\147\145"]; } else if ($l4["mi\163\143\137plugin_l\141\156\147uage_ar\145\141"] == "\142\157\164h") { return $l4["\155\151\163c_plugin\137\154\141nguage"]; } else { return $locale; } } function lmm_compatibility_checks() { include ("inc".DIRECTORY_SEPARATOR."compati\142\151\154ity-che\143\153\163.php"); } function lmm_help() { include ("leafle\164\055\150elp-cr\145\144\151ts.php"); } function lmm_settings() { global $Oi; $Oi->display_page(); } function lmm_list_layers() { include ("\154\145aflet-l\151\163\164-layers\056\160\150p"); } function lmm_list_markers() { include ("leaflet-l\151\163\164-marker\163\056\160hp"); } function lmm_layer() { include ("l\145\141\146let-laye\162\056\160hp"); } function lmm_marker() { include ("leafl\145\164\055marker.\160\150\160"); } function lmm_import_export() { include ("l\145\141\146let-impo\162\164\055export\056\160\150p"); } function lmm_tools() { include ("\154\145\141flet-t\157\157\154s.php"); } function lmm_apis() { if (!current_user_can("a\143\164\151vate_pl\165\147\151ns")) { return; } settings_errors(); require_once l2."\151\156c".DIRECTORY_SEPARATOR."\141\144min-hea\144\145\162.php"; require_once l2."inc".DIRECTORY_SEPARATOR."\141\144min-con\164\145\156t-apis.\160\150\160"; require_once l2."in\143".DIRECTORY_SEPARATOR."class-\141\160\151-keys-ta\142\154\145.php"; $lj=new mmp_api_keys_table(); $lj->prepare_items(); $lj->display(); require_once l2."i\156\143".DIRECTORY_SEPARATOR."\141\144\155in-foot\145\162\056php"; } function lmm_add_georss_to_head() { $georss_to_head="<link re\154\075\042altern\141\164\145\042 ty\160\145\075\042ap\160\154\151cation\057\162\163s+xml\042\040\164itle=\042".get_bloginfo("name")." G\145\157\122SS-Feed\042 href=\042".mmp_globals::translate_permalink(mmp_rewrite::get_base_url().mmp_rewrite::get_slug()."\057\147\145orss/l\141\171\145r/all/")."\042\040/>".PHP_EOL; echo $georss_to_head; } function lmm_showmap($atts) { require ("i\156\143".DIRECTORY_SEPARATOR."\163\150owmap_\160\162\145pare.ph\160"); $Oj=apply_filters("mm\160\137\155ap_cont\145\156\164",$Oj,$atts); return $Oj; } function lmm_load_settings_class() { if (is_admin()) { require_once (plugin_dir_path( __FILE__)."\151nc".DIRECTORY_SEPARATOR."class\055\154\145aflet-o\160\164\151ons.php"); global $Oi; $Oi=new class_leaflet_options(); } } function lmm_admin_menu() { global $wp_version; if (version_compare($wp_version,"\063.8-al\160\150\141",">")) { $lk="-white"; } else { $lk=""; } $l4=get_option("l\145\141\146letmaps\155\141\162ker_opt\151\157\156s"); if (!empty($l4)) { $capabilities=$l4["\143apabili\164\151\145s_view_o\164\150\145rs"]; $Ok="\141\143\164ivate_\160\154\165gins"; $ll=$l4["capa\142\151\154ities_e\144\151\164_others"]; } else { $capabilities="\145\144it_posts"; $Ok="\141ctivate\137\160\154ugins"; $ll="\141\143\164ivate_pl\165\147\151ns"; } if (!empty($l4)) { if ($l4["mis\143\137\167hitelabe\154\137\142ackend"] == "en\141\142\154ed") { $lm=esc_attr__("M\141\160\163","\154mm"); $Ok="\141ctivate_\160\154\165gins"; $ll=$l4["\143\141\160abiliti\145\163\137edit_ot\150\145\162s"]; } else { $lm="<span s\164\171\154e=\042fo\156\164\055size:92\045\073\042>Map\163\040\115arker \120\162\157</span\076"; $Ok=$l4["capa\142\151\154ities_v\151\145\167_others"]; $ll=$l4["\143apabili\164\151\145s_edit_\157\164\150ers"]; } } else { $lm="\115\141ps Marke\162\040\120ro"; $Ok="a\143\164\151vate_plu\147\151\156s"; $ll="ac\164\151\166ate_plug\151\156\163"; } $page=add_menu_page($lm,$lm,$capabilities,"l\145\141\146letmaps\155\141\162ker_mar\153\145\162s",array(&$this,"\154mm_lis\164\137\155arkers"),O1."\151nc/img\057\151\143on-menu\055\160\141ge".$lk."\056\160\156g","25.071"); if (!empty($l4)) { $page2=add_submenu_page("\154eafletma\160\163\155arker_m\141\162\153ers",$lm."\040- ".__("Li\163\164\040all mar\153\145\162s","lmm"),"\074\151\155g src=\042".O1."i\156\143\057img/ico\156\055\155enu-li\163\164".$lk.".png\042\076\040".__("List al\154\040\155arkers","\154\155\155"),$l4["\143\141pabiliti\145\163\137view_oth\145\162\163"],"lea\146\154\145tmapsmar\153\145\162_marker\163",array(&$this,"l\155\155\137list_mar\153\145\162s")); $page3=add_submenu_page("le\141\146\154etmapsma\162\153\145r_marke\162\163",$lm."\040\055\040".__("a\144\144\057edit ma\162\153\145r","lmm"),"<im\147\040\163rc=\042".O1."\151nc/img\057\151\143on-menu\055\141\144d".$lk.".p\156\147\042> ".__("Add\040\156\145w marke\162","\154\155\155"),$l4["\143apabili\164\151\145s_view_o\164\150\145rs"],"leaflet\155\141\160smarker\137\155\141rker",array(&$this,"\154mm_mar\153\145\162")); $page4=add_submenu_page("l\145\141\146letmaps\155\141\162ker_mar\153\145\162s",$lm." - ".__("List al\154\040\154ayers","lmm"),"\074\151mg src=\042".O1."inc/img\057\151\143on-menu\055\154\151st".$lk.".png\042\076\040".__("List \141\154\154 layers","lm\155"),$l4["capa\142\151\154ities_vi\145\167\137others"],"\154\145\141fletma\160\163\155arker_\154\141\171ers",array(&$this,"lmm_list\137\154\141yers")); $page5=add_submenu_page("leaf\154\145\164mapsmark\145\162\137marker\163",$lm."\040\055\040".__("add/edit\040\154\141yer","lmm"),"<img s\162\143\075\042".O1."\151nc/img/i\143\157\156-menu-ad\144".$lk."\056png\042> ".__("A\144\144\040new lay\145\162","\154mm"),$l4["\143\141pabiliti\145\163\137view_o\164\150\145rs"],"leaf\154\145\164mapsmar\153\145\162_layer",array(&$this,"\154mm_laye\162")); $page8=add_submenu_page("l\145\141\146letmaps\155\141\162ker_mark\145\162\163",$lm."\040- ".__("Suppor\164","lmm"),"\074\151mg src=\042".O1."\151\156c/img/ic\157\156\055menu-h\145\154\160".$lk.".png\042\076\040".__("\123\165pport","lmm"),$Ok,"\154\145\141fletmap\163\155\141rker_he\154\160",array(&$this,"\154mm_hel\160")); } else { $page=""; $page2=""; $page3=""; $page4=""; $page5=""; $page8=""; } if (!empty($l4)) { $page3b=add_submenu_page("l\145\141\146letmaps\155\141\162ker_mar\153\145\162s",$lm." - ".__("Import/E\170\160\157rt","lmm"),"\074hr noshad\145\040\163ize=\042\061\042 style=\042\155\141rgin-t\157\160\0720px;\042\057\076<img s\162\143\075\042".O1."\151\156\143/img/ico\156\055\155enu-im\160\157\162t-expor\164".$lk.".png\042\076\040".__("Import/Ex\160\157\162t","lmm"),$l4["\143\141pabilit\151\145\163_view_o\164\150\145rs"],"\154\145\141fletmaps\155\141\162ker_imp\157\162\164_export",array(&$this,"l\155\155\137import_e\170\160\157rt")); } else { $page3b=""; } $page6=add_submenu_page("\154\145\141fletma\160\163\155arker_m\141\162\153ers",$lm." - ".__("\124\157ols","\154\155m"),"<img sr\143\075\042".O1."\151nc/img/i\143\157\156-menu-t\157\157\154s".$lk.".png\042\076\040".__("Too\154\163","\154\155m"),$ll,"\154\145\141fletma\160\163\155arker_t\157\157\154s",array(&$this,"\154mm_tools")); $page7=add_submenu_page("l\145\141\146letmaps\155\141\162ker_mar\153\145\162s",$lm." - ".__("Sett\151\156\147s","lmm"),"\074\151\155g src=\042".O1."\151\156c/img/ic\157\156\055menu-\163\145\164tings".$lk."\056png\042\076\040".__("Setti\156\147\163","lmm"),"\141\143tivate_\160\154\165gins","\154\145\141fletmap\163\155\141rker_setting\163",array(&$this,"lmm\137\163\145ttings")); $page11=add_submenu_page("le\141\146\154etmaps\155\141\162ker_mar\153\145\162\163",$lm."\040\055 ".__("Maps Mark\145\162\040APIs","lm\155"),"\074img src=\042".O1."in\143\057\151mg/icon\055\155\145nu-api".$lk."\056\160ng\042> ".__("\115\141\160s Marke\162\040\101PIs","lmm"),$Ok,"lea\146\154\145tmapsma\162\153\145r_apis",array(&$this,"lmm_apis")); if (!empty($l4)) { $page10=add_submenu_page("\154eaflet\155\141\160smarker_\155\141\162kers",$lm." - ".__("\114icense s\145\164\164ings","lmm"),"\074\150\162 nosha\144\145\040size=\042\061\042 style=\042\155\141rgin-to\160\072\060px;\042\057\076<img sr\143\075\042".O1."in\143\057\151mg/icon\055\155\145nu-se\164\164\151ngs".$lk."\056\160\156g\042> ".__("L\151\143\145nse sett\151\156\147s","lmm"),$Ok,"lea\146\154\145tmapsmar\153\145\162_licen\163\145","maps_ma\162\153\145r_pro_li\143\145\156se_acti\166\141\164ion_pa\147\145"); } else { $page10=""; } if (!empty($l4)) { $Om=add_submenu_page("\154eafletm\141\160\163marker_\155\141\162kers",$lm."\040- ".__("Update t\157\040\115aps Mar\153\145\162 Pro v4\056\060","lmm"),"<div \163\164\171le=\042b\141\143\153ground:\043\146\146ff00;c\157\154\157r:#000\073\160\141dding\072\063px;line\055\150\145ight\072\061.8em;\042\076\074img s\162\143\075\042".O1."i\156\143\057img/ico\156\055\165p.png\042\076\040".__("\125\160date to \166\064\0560","lm\155")."&nbsp\073\046\156bsp;&nb\163\160\073</div>",$l4["\143apabilit\151\145\163_edit"],"lea\146\154\145tmapsmar\153\145\162_updat\145\137\155mp4",array(&$this,"l\155\155\137update_m\155\160\064")); } else { $Om=""; } add_action("\141dmin_prin\164\137\163cripts-".$page3,array(&$this,"lmm_a\144\155\151n_enque\165\145\137scripts"),7); add_action("admin_pri\156\164\137script\163\055".$page5,array(&$this,"lm\155\137\141dmin_en\161\165\145ue_scri\160\164\163"),8); add_action("\141\144min_pri\156\164\137scripts\055".$page2,array(&$this,"lm\155\137\141dmin_se\154\145\143tjs"),011); add_action("admi\156\137\160rint_st\171\154\145s-".$page3,array(&$this,"l\155\155\137admin_se\154\145\143tjs"),011); add_action("adm\151\156\137print_st\171\154\145s-".$page5,array(&$this,"\154\155\155_admin_\163\145\154ectjs"),011); add_action("\141\144\155in_prin\164\137\163cripts-".$page7,array(&$this,"\154mm_admi\156\137\163electjs"),011); add_action("admin_pr\151\156\164_script\163\055".$page4,array(&$this,"lmm_\141\144\155in_selectjs"),011); add_action("\141dmin_pr\151\156\164_script\163\055".$page11,array(&$this,"lmm_adm\151\156\137selectj\163"),011); add_action("a\144\155\151n_print_\163\143\162ipts-".$page3,array(&$this,"lmm_adm\151\156\137ajax_act\151\157\156sjs_bac\153\145\156d"),012); add_action("adm\151\156\137print_sc\162\151\160ts-".$page5,array(&$this,"\154mm_admin_\141\152\141x_actio\156\163\152s_backe\156\144"),012); add_action("admin_pr\151\156\164_styles\055".$page3,array(&$this,"lmm\137\141\144min_enqu\145\165\145_styles\150\145\145ts_lea\146\154\145t"),023); add_action("ad\155\151\156_print_\163\164\171les-".$page5,array(&$this,"lm\155\137\141dmin_en\161\165\145ue_style\163\150\145ets_lea\146\154\145t"),023); add_action("\141dmin_p\162\151\156t_styles\055".$page,array(&$this,"\154mm_adm\151\156\137enqueue_\163\164\171leshee\164\163"),021); add_action("\141dmin_prin\164\137\163tyles-".$page2,array(&$this,"\154mm_adm\151\156\137enqueue_\163\164\171leshee\164\163"),022); add_action("admin_p\162\151\156t_style\163\055".$page3,array(&$this,"lmm_adm\151\156\137enqueue\137\163\164yleshee\164\163"),023); add_action("admin_pri\156\164\137styles-".$page3b,array(&$this,"lmm_adm\151\156\137enqueue\137\163\164yleshee\164\163"),023); add_action("adm\151\156\137print_s\164\171\154es-".$page4,array(&$this,"\154mm_admin\137\145\156queue_s\164\171\154esheets"),024); add_action("\141\144\155in_pri\156\164\137styles-".$page5,array(&$this,"\154\155m_admin_\145\156\161ueue_st\171\154\145sheets"),025); add_action("\141dmin_prin\164\137\163tyles-".$page6,array(&$this,"\154mm_admi\156\137\145nqueue_s\164\171\154esheets"),026); add_action("\141\144\155in_prin\164\137\163tyles-".$page7,array(&$this,"\154mm_admin_\145\156\161ueue_st\171\154\145sheets"),027); add_action("\141\144\155in_prin\164\137\163tyles-".$page8,array(&$this,"lmm_admin\137\145\156queue_s\164\171\154esheets"),030); add_action("ad\155\151\156_print_\163\164\171les-".$page10,array(&$this,"\154\155\155_admin_e\156\161\165eue_st\171\154\145sheets"),031); add_action("\141\144\155in_print\137\163\164yles-".$page11,array(&$this,"lmm_admi\156\137\145nqueue_\163\164\171leshee\164\163"),032); add_action("adm\151\156\137print_st\171\154\145s-".$Om,array(&$this,"\154\155m_admi\156\137\145nqueue_\163\164\171lesheets"),032); add_action("\141dmin_enq\165\145\165e_scri\160\164\163",array(&$this,"\154\155m_admin_\145\156\161ueue_s\164\171\154esheets\137\141\144minbar"),031); add_action("ad\155\151\156_print_\163\143\162ipts-".$page,array(&$this,"\154mm_add_c\157\156\164extual_\150\145\154p")); add_action("\141dmin_pri\156\164\137scripts\055".$page2,array(&$this,"\154\155\155_add_con\164\145\170tual_hel\160")); add_action("\141\144min_print\137\163\143ripts-".$page3,array(&$this,"l\155\155\137add_cont\145\170\164ual_hel\160")); add_action("\141\144min_prin\164\137\163cripts-".$page3b,array(&$this,"\154mm_add_c\157\156\164extual_\150\145\154p")); add_action("\141\144min_prin\164\137\163cripts\055".$page4,array(&$this,"lmm_ad\144\137\143ontextua\154\137\150elp")); add_action("admin_pri\156\164\137scripts\055".$page5,array(&$this,"lmm_add_\143\157\156textual_\150\145\154p")); add_action("\141\144\155in_prin\164\137\163cripts-".$page6,array(&$this,"\154mm_add\137\143\157ntextual\137\150\145lp")); add_action("admin_pri\156\164\137scripts\055".$page7,array(&$this,"\154mm_add\137\143\157ntextua\154\137\150elp")); add_action("\141dmin_prin\164\137\163cripts-".$page8,array(&$this,"\154\155m_add_co\156\164\145xtual_\150\145\154p")); add_action("\141\144\155in_prin\164\137\163cripts-".$page10,array(&$this,"lmm_add_\143\157\156textual\137\150\145lp")); add_action("a\144\155\151n_print_\163\143\162ipts-".$page11,array(&$this,"\154\155m_add_co\156\164\145xtual_h\145\154\160")); add_action("admin_\160\162\151nt_scrip\164\163\055".$Om,array(&$this,"lmm_add_\143\157\156textual\137\150\145lp")); add_action("admin_pri\156\164\137scripts-".$page7,array(&$this,"lmm_adm\151\156\137bootstr\141\160\137tabs"),011); } function lmm_update_mmp4() { include ("\154\145aflet-\165\160\144ate-mmp\064\056\160hp"); } function lmm_add_admin_bar_menu() { global $wp_version; $l4=get_option("\154\145\141fletmap\163\155\141rker_op\164\151\157ns"); $ln=( isset ($_GET["\160age"]) ? $_GET["\160age"]: ""); if ($ln == "leafle\164\155\141psmarke\162\137\155arker") { $On="\043"; } else { $On=l1."admin.\160\150\160?page=l\145\141\146letmapsm\141\162\153er_mar\153\145\162"; } if ($ln == "\154\145\141fletmaps\155\141\162ker_la\171\145\162") { $lo="#"; } else { $lo=l1."\141\144min.php\077\160\141ge=lea\146\154\145tmapsmar\153\145\162_layer"; } if ($l4["\141dmin_bar_\151\156\164egratio\156"] == "e\156\141\142\154ed" && current_user_can($l4["\143\141pabiliti\145\163\137view_oth\145\162\163"])) { global $wp_admin_bar; if ($l4["\155\151\163c_whit\145\154\141bel_bac\153\145\156d"] == "\145nabled") { $Oo=esc_attr__("Maps","lmm"); $lp=""; } else { $Oo="Ma\160\163\040Marker\040\120\162o"; $lp=array("\164\151\164le" => "\127\157rdpress\055\120\154ugin ".__("by","\154\155m")."\040www.map\163\155\141rker.com"); } if (version_compare($wp_version,"3.8-a\154\160\150a","\076")) { $lk="\055white"; $Op="\074\163\160an cla\163\163\075\042ab-\151\143\157n\042><\057\163\160an><s\160\141\156 class=\042\141\142-labe\154\042\076".$Oo."\074\057span>"; } else { $Op="<img sty\154\145\075\042fl\157\141\164:left;m\141\162\147in:3p\170\040\065px 0 \060\073\042 src\075\042".O1."inc/img\057\151\143on-tiny\155\143\145.png\042\057\076 ".$Oo; $lk=""; } $menu_items=array(array("\151\144" => "\154mm","\164\151tle" => $Op,"hre\146" => "","\155\145\164a" => $lp),array("\151\144" => "\154\155m-marke\162\163","\160\141\162ent" => "lmm","\164\151\164le" => "\074\151mg src=\042".O1."in\143\057\151mg/icon\055\155\145nu-lis\164".$lk.".png\042\076\040".__("\114\151\163t all \155\141\162kers","\154mm"),"href" => l1."\141dmin.p\150\160\077page=le\141\146\154etmapsm\141\162\153er_ma\162\153\145rs"),array("id" => "lmm-add\055\155\141rker","\160arent" => "lmm","\164\151tle" => "\074img src=\042".O1."inc\057\151\155g/icon\055\155\145nu-add".$lk."\056\160ng\042> ".__("\101dd new ma\162\153\145r","lmm"),"href" => $On),array("\151d" => "lmm-lay\145\162\163","\160\141\162ent" => "lmm","\164\151tle" => "\074img src=\042".O1."inc\057\151\155g/icon-\155\145\156u-list".$lk."\056\160ng\042> ".__("\114\151\163t all l\141\171\145rs","lmm"),"hr\145\146" => l1."ad\155\151\156.php?pag\145\075\154eaflet\155\141\160smarke\162\137\154ayers"),array("id" => "\154\155\155-add-lay\145\162\163","\160arent" => "lmm","\164\151\164le" => "\074\151\155g src=\042".O1."inc/\151\155\147/icon-m\145\156\165-add".$lk."\056\160\156g\042> ".__("Add new \154\141\171er","lmm"),"hr\145\146" => $lo),array("id" => "lmm-h\145\154\160-credits","par\145\156\164" => "\154mm","t\151\164\154e" => "\074\151\155g src=\042".O1."in\143\057\151mg/icon\055\155\145nu-hel\160".$lk."\056png\042>\040".__("\123upport","lmm"),"h\162\145\146" => l1."\141\144min.php?\160\141\147e=leafl\145\164\155apsmark\145\162\137help"),array("id" => "lmm-imp\157\162\164-export","parent" => "lmm","ti\164\154\145" => "\074hr style=\042\155\141rgin:3p\170\040\060;\042 \156\157\163hade si\172\145\075\0421\042\057\076<img \163\162\143=\042".O1."\151\156\143/img/ic\157\156\055menu-i\155\160\157rt-expo\162\164".$lk."\056\160\156g\042> ".__("\111mport/Ex\160\157\162t","lmm"),"href" => l1."admin.p\150\160\077page=le\141\146\154etmaps\155\141\162ker_im\160\157\162t_exp\157\162\164")); if (current_user_can("acti\166\141\164e_plugin\163") && ($l4["\155\151sc_white\154\141\142el_backe\156\144"] == "\144isabled")) { $menu_items=array_merge($menu_items,array(array("\151\144" => "\154mm-tools","\160\141rent" => "lmm","title" => "\074\151mg src=\042".O1."\151\156\143/img/ic\157\156\055menu-t\157\157\154s".$lk.".\160\156\147\042> ".__("\124ools","lmm"),"href" => l1."\141\144min.php\077\160\141ge=lea\146\154\145tmapsma\162\153\145r_tools"),array("id" => "lmm-setti\156\147\163","\160\141rent" => "lmm","titl\145" => "\074img sr\143\075\042".O1."\151nc/img/ic\157\156\055menu-s\145\164\164ings".$lk."\056\160ng\042> ".__("\123\145\164tings","lmm"),"href" => l1."\141\144min.php\077\160\141ge=lea\146\154\145tmapsma\162\153\145r_setti\156\147\163"),array("\151\144" => "\154\155\155-apis","\160arent" => "\154\155\155","title" => "<\151\155\147 src=\042".O1."\151\156c/img/i\143\157\156-menu-a\160\151".$lk."\056\160ng\042> M\141\160\163 Marker\040\101\120Is","href" => l1."\141\144min.php?\160\141\147e=leaf\154\145\164mapsmar\153\145\162_apis"))); } if ($l4["\155\151\163c_white\154\141\142el_backe\156\144"] == "\144isabled") { $menu_items=array_merge($menu_items,array(array("\151d" => "\154\155m-lice\156\163\145","\160\141rent" => "lmm","title" => "\074\150\162 style\075\042\155argin:\063\160\170 0;\042\040\156\157shade\040\163\151ze=\042\061\042\057><im\147\040\163rc=\042".O1."\151nc/img/\151\143\157n-menu-\163\145\164tings".$lk."\056\160ng\042> ".__("\114\151cense s\145\164\164ings","\154\155\155"),"href" => l1."\141\144min.php\077\160\141ge=le\141\146\154etmapsm\141\162\153er_lic\145\156\163e"))); } $menu_items=array_merge($menu_items,array(array("\151\144" => "\154\155m-upda\164\145\055mmp4","parent" => "lmm","t\151\164\154e" => "\074span \163\164\171le=\042b\141\143\153ground:\043\146\146ff00;c\157\154\157r:#000\073\160\141dding\072\063px;text\055\163\150adow:\156\157\156e;\042\076\074img sr\143\075\042".O1."inc/i\155\147\057icon-u\160\056\160ng\042>\040".__("\125\160\144ate to \166\064\0560","lm\155")."&nb\163\160\073&nbsp;\074\057\163pan>","href" => l1."\141dmin.ph\160\077\160age=lea\146\154\145tmapsma\162\153\145r_upda\164\145\137mmp4"))); foreach ($menu_items as $menu_item) { $wp_admin_bar->add_menu($menu_item); } } } function lmm_add_contextual_help() { $helptext="<p>".__("Do you \150\141\166e ques\164\151\157ns or i\163\163\165es? Pl\145\141\163e use t\150\145\040follo\167\151\156g sup\160\157\162t cha\156\156\145ls ap\160\162\157priat\145\154\171.","\154\155\155")."<br\057\076"; $helptext.="\074stron\147\076".__("\102efore you\040\160\157st a \156\145\167 suppor\164\040\164icket,\040\160\154ease \146\157\154low th\145\040instruc\164\151\157ns fr\157\155 <a hre\146\075\042htt\160\072\057/www\056\155apsmark\145\162\056com/\162\145\141dme-f\151\162\163t\042\040\164\141rget\075\042_blank\042\076\150ttp:\057\057www.ma\160\163marker\056\143om/rea\144\155\145-firs\164\074/a> wh\151\143h give\040\171ou a g\165\151deline\040\157n how\040\164\157 de\141\154\040wit\150\040the mo\163\164 comm\157\156\040iss\165\145s.","lmm")."</strong>\074\057\160>"; $helptext.="<ul>"; $helptext.="\074\154i><a hr\145\146\075\042htt\160\163\072//www.\155\141\160smarke\162\056\143om/fa\161\057\042 targ\145\164\075\042_b\154\141\156k\042\076".__("\106AQ","\154mm")."\074/a> (".__("fr\145\161\165ently as\153\145\144 quest\151\157\156s","\154\155\155")."\051\074/li>"; $helptext.="\074li><a hre\146\075\042https\072\057\057www.m\141\160\163marker.\143\157\155/docs/\042\040\164arget\075\042\137blank\042\076".__("\104ocumentat\151\157\156","lmm")."\074/a></li>"; $helptext.="\074\154\151><a hre\146\075\042https:\057\057www.maps\155\141\162ker.co\155\057\154ogin\042\040\164arget=\042\137\142lank\042\076\155apsma\162\153\145r.com\057\154\157gin</\141\076 (".__("support \146\157\162 pro us\145\162\163","lmm")."\051</li>"; $helptext.="\074\057ul>"; $screen=get_current_screen(); $screen->add_help_tab(array("\151d" => "lmm_hel\160\137\164ab","\164itle" => __("\110elp & \123\165\160port","lmm"),"c\157\156\164ent" => $helptext)); } function lmm_admin_selectjs() { $O4=get_option("\154\145afletmap\163\155\141rker_v\145\162\163ion_pro"); wp_enqueue_script(array("\152\161uery")); wp_enqueue_script("\154eafletma\160\163\155arker-\154\151\163t-marke\162\163\055layer\163",O1."in\143\057\152s/list-\155\141\162kers-l\141\171\145rs.js",array("\152query"),$O4); wp_localize_script("lea\146\154\145tmapsma\162\153\145r-list\055\155\141rkers-\154\141\171ers","lmm_aja\170\137\166ars",array("\154mm_ajax\137\156\157nce" => wp_create_nonce("lm\155\055\141jax-non\143\145"),"\154mm_aja\170\137\143urrent_\160\141\147e" => ( isset ($_GET["page"]) ? $_GET["page"]: ""),"\154\155m_ajax_l\145\141\146let_plu\147\151\156_url" => O1)); wp_enqueue_script("leaflet\155\141\160smarker\055\163\145lect2",O1."\151\156\143/js/sel\145\143\1642/selec\164\062\056min.js",array("jquery"),$O4); wp_enqueue_style("\154\145\141fletmap\163\155\141rker-se\154\145\143t2",O1."\151nc/js/\163\145\154ect2/sel\145\143\1642.css",array(),$O4); wp_localize_script("\154\145afletmap\163\155\141rker-s\145\154\145ct2","\155apsmarke\162\152\163pro_sele\143\164\152s",array("\163etting\163\137\163earch_pl\141\143\145holder" => __("\163\164\141rt full\055\164\145xt sea\162\143\150","lmm"),"setti\156\147\163_search_\156\157\137results" => __("N\157\040\155atches\040\146\157und","lmm"),"lmm_cu\162\162\145nt_page" => ( isset ($_GET["\160\141\147e"]) ? $_GET["pa\147\145"]: ""))); } function lmm_admin_ajax_actionsjs_backend() { $l4=get_option("leafl\145\164\155apsmar\153\145\162_option\163"); if ($l4["\144\145faults_m\141\162\153er_cust\157\155\137icon_u\162\154\137dir"] == "no") { $defaults_marker_icon_url=LEAFLET_PLUGIN_ICONS_URL; } else { $defaults_marker_icon_url=esc_url($l4["\144efault\163\137\155arker_ic\157\156\137url"]); } $O4=get_option("\154eafletmap\163\155\141rker_v\145\162\163ion_pro"); wp_enqueue_script(array("j\161\165\145ry")); wp_enqueue_script("leaf\154\145\164mapsmar\153\145\162-ajax-ac\164\151\157ns-js-b\141\143\153end",O1."\151nc/js/aj\141\170\055action\163\055\142ackend\056\152\163",array("\152\161\165ery"),$O4); wp_localize_script("\154\145\141fletmap\163\155\141rker-aj\141\170\055actions\055\152\163-back\145\156\144","\154mm_ajax\137\166\141rs",array("l\155\155\137ajax_non\143\145" => wp_create_nonce("lmm-ajax-\156\157\156ce"),"lmm_\141\152\141x_curre\156\164\137page" => ( isset ($_GET["pag\145"]) ? $_GET["\160\141ge"]: ""),"\154\155\155_ajax_\143\157\156firm_de\154\145\164e" => esc_attr__("Do you re\141\154\154y want \164\157\040delete \164\150\151s mark\145\162\077 (can\156\157\164 be u\156\144\157ne)","\154\155\155"),"lmm_aj\141\170\137shortcod\145" => htmlspecialchars($l4["shortc\157\144\145"]),"\154\155m_ajax_\163\151\164e_url" => mmp_rewrite::get_base_url(),"lmm_ajax\137\154\155m_slug" => mmp_rewrite::get_slug(),"lmm_ajax\137\154\145aflet_p\154\165\147in_url" => O1,"lmm\137\141\152ax_text_\156\157\137results\137\146\157und" => __("\116\157\040matche\163\040\146ound","l\155\155"),"\154\155m_ajax\137\141\144min_url" => l1,"lmm_ajax_\165\162\154" => admin_url("\141dmin-aja\170\056\160hp"),"l\155\155\137ajax_mis\143\137\153ml" => $l4["m\151\163\143_kml"],"lm\155\137\147et_dire\143\164\151ons_text" => esc_attr__("\107et dir\145\143\164ions","lmm"),"lmm_dir\145\143\164ions_tex\164" => __("Direct\151\157\156s","\154mm"),"lmm_defa\165\154\164s_marke\162\137\151con_url" => $defaults_marker_icon_url)); } function lmm_admin_bootstrap_tabs() { global $wp_scripts; if ( isset ($wp_scripts->registered) && is_array($wp_scripts->registered)) { foreach ($wp_scripts->registered as $script) { if ((strpos($script->handle ,"b\157\157\164strap") !== FALSE) || (strpos($script->src ,"bo\157\164\163trap") !== FALSE)) { wp_dequeue_script($script->handle); wp_deregister_script($script->handle); } } } $O4=get_option("\154\145afletmap\163\155\141rker_v\145\162\163ion_pro"); wp_enqueue_script(array("jq\165\145\162y")); wp_enqueue_script("lea\146\154\145tmapsma\162\153\145r-boots\164\162\141p-tabs",O1."\151nc/js/boo\164\163\164rap-tab\163\056\155in.js",array("\152\161uery"),$O4); } function lmm_frontend_enqueue_scripts() { global $locale; $l4=get_option("leaflet\155\141psmarke\162\137\157ptions"); $O4=get_option("\154eafletma\160\163\155arker_v\145\162\163ion_pr\157"); if ($l4["\147oogle_ma\160\163\137api_sta\164\165\163"] == "disabled" || $l4["\147oogle_\155\141\160s_api_de\146\145\162red_loa\144\151\156g"] == "enabl\145\144") { if ($l4["misc_ja\166\141\163cript_h\145\141\144er_foote\162\137\160ro"] == "foot\145\162") { wp_register_script("leafl\145\164\155apsmarke\162\055\143ore",O1."\154\145aflet-di\163\164\057leafle\164\055\143ore.js",array(),$O4,FALSE); wp_register_script("le\141\146\154etmapsma\162\153\145r-addon\163",O1."\154eaflet-di\163\164\057leafl\145\164\055addons.\152\163",array("leaf\154\145\164mapsmark\145\162\055core"),$O4,FALSE); wp_register_script("show\137\155\141p",O1."\151\156\143/js/sh\157\167\137map.js",array("\152query","leafletma\160\163\155arker-co\162\145","leaflet\155\141\160smarker-\141\144\144ons"),$O4,FALSE); } else { wp_enqueue_script("le\141\146\154etmapsm\141\162\153er-core",O1."\154\145\141flet-dis\164\057\154eaflet\055\143\157re.js",array(),$O4,FALSE); wp_enqueue_script("leafletm\141\160\163marker-\141\144\144ons",O1."leafl\145\164\055dist/le\141\146\154et-addo\156\163\056js",array("\152\161\165ery","le\141\146\154etmapsma\162\153\145r-core"),$O4,FALSE); } } else { if ( isset ($l4["\147\157ogle_ma\160\163\137api_ke\171"]) && ($l4["google_m\141\160\163_api_ke\171"] != NULL)) { $google_maps_api_key="?k\145\171\075".esc_js(trim($l4["\147oogle_\155\141\160s_api_ke\171"])); } else { $google_maps_api_key=""; } if ($l4["misc_\152\141\166ascript\137\150\145ader_f\157\157\164er_pro"] == "\146\157oter") { wp_register_script("\154\145afletm\141\160\163marker\055\147\157oglema\160\163\055load\145\162","ht\164\160\163://www.g\157\157\147le.com\057\152\163api".$google_maps_api_key,array(),NULL,TRUE); } else { wp_enqueue_script("\154\145afletmap\163\155\141rker-g\157\157\147lemaps-\154\157\141der","\150ttps://w\167\167\056google\056\143\157m\057\152\163api".$google_maps_api_key,array(),NULL,TRUE); } if ($l4["mis\143\137\152avascri\160\164\137header_\146\157\157ter_pro"] == "\146\157\157ter") { wp_register_script("leafl\145\164\155apsmark\145\162\055core",O1."\154\145aflet-di\163\164\057leafl\145\164\055core.js",array("l\145\141\146letmaps\155\141\162ker-goo\147\154\145maps-lo\141\144\145r"),$O4,FALSE); wp_register_script("leafletma\160\163\155arker-a\144\144\157ns",O1."leafl\145\164\055dist/le\141\146\154et-addo\156\163\056js",array("\154eafletma\160\163\155arker-c\157\162\145"),$O4,FALSE); wp_register_script("\163\150\157w_map",O1."\151nc/js/sh\157\167\137map.js",array("jquery","leafle\164\155\141psmarke\162\055\143ore","\154\145afletm\141\160\163marker-\141\144\144ons"),$O4,FALSE); } else { wp_enqueue_script("\154eafletm\141\160\163marker-\143\157\162e",O1."leafle\164\055\144ist/lea\146\154\145t-core.\152\163",array("lea\146\154\145tmapsma\162\153\145r-google\155\141\160s-loade\162"),$O4,FALSE); wp_enqueue_script("leafl\145\164\155apsmarke\162\055\141ddons",O1."l\145\141\146let-dis\164\057\154eaflet-\141\144\144ons.js",array("\154eafletm\141\160\163marker-\143\157\162e"),$O4,FALSE); } } if ($l4["\155apquest\137\141\160i_key"] != NULL) { if ($l4["misc_ja\166\141\163cript_h\145\141\144er_foot\145\162\137pro"] == "foot\145\162") { wp_register_script("l\145\141\146letmaps\155\141\162ker-map\161\165\145st","https://w\167\167\056mapques\164\141\160i.com/s\144\153\057leafle\164\057\1662.2/mq\055\155\141p.js?k\145\171\075".esc_js(trim($l4["\155\141pquest_a\160\151\137key"])),array("\154eafletmap\163\155\141rker-co\162\145"),$O4,FALSE); } else { wp_enqueue_script("\154eafletm\141\160\163marker-\155\141\160quest","https:/\057\167\167w.mapqu\145\163\164api.com\057\163\144k/leaf\154\145\164/v2.2/\155\161\055map.js\077\153\145y=".esc_js(trim($l4["mapquest\137\141\160i_key"])),array("\154\145\141fletmap\163\155\141rker-co\162\145"),$O4,FALSE); } } $google_styling_json=($l4["\147\157\157gle_sty\154\151\156g_json"] == NULL) ? "dis\141\142\154ed": str_replace("\042","'",$l4["google_\163\164\171ling_jso\156"]); if ($l4["\142\151ngmaps_\143\165\154ture"] == "\141utomati\143") { if ($locale != NULL) { $bing_culture=str_replace("_","\055",$locale); } else { $bing_culture="\145\156_us"; } } else { $bing_culture=$l4["\142\151ngmaps_\143\165\154ture"]; } if ($l4["\147\157ogle_map\163\137\154anguage\137\154\157calizat\151\157\156"] == "brow\163\145\162_setting") { $google_language=""; } else if ($l4["googl\145\137\155aps_lang\165\141\147e_local\151\172\141tion"] == "wor\144\160\162ess_sett\151\156\147") { if ($locale != NULL) { $google_language="&lang\165\141\147e=".substr($locale,0,2); } else { $google_language="&languag\145\075\145n"; } } else { $google_language="&langua\147\145\075".esc_html($l4["\147oogle_map\163\137\154anguage\137\154\157calizat\151\157\156"]); } if ($l4["google_m\141\160\163_base_do\155\141\151n_cust\157\155"] == "") { $gmaps_base_domain="&ba\163\145\137domain=".esc_html($l4["\147oogle_map\163\137\142ase_dom\141\151\156"]); } else { $gmaps_base_domain="\046\142ase_doma\151\156\075".esc_html($l4["\147oogle_map\163\137\142ase_doma\151\156\137custom"]); } wp_localize_script("leafletm\141\160\163marker-\143\157\162e","ma\160\163\155arkerjsp\162\157",array("\172\157om_in" => __("Zo\157\155\040in","lmm"),"zoom\137\157\165t" => __("\132oom out","lmm"),"google_m\141\160\163_api_st\141\164\165s" => esc_js($l4["\147\157ogle_ma\160\163\137api_sta\164\165\163"]),"goo\147\154\145_maps_p\154\165\147in" => esc_js($l4["\147\157ogle_m\141\160\163_plugin"]),"\147\157ogle_def\145\162\162ed_load\151\156\147" => esc_js($l4["google_ma\160\163\137api_def\145\162\162ed_load\151\156\147"]),"\147\157\157glemap\163\137\154anguage" => $google_language,"\147ooglemap\163\137\142ase_dom\141\151\156" => $gmaps_base_domain,"go\157\147\154\145_maps_\141\160\151_key" => esc_js(trim($l4["google_\155\141\160s_api_k\145\171"])),"\147\157\157\147le_sty\154\151\156g_json" => $google_styling_json,"bing\137\143\165lture" => $bing_culture,"\155\151n\151map_show" => __("S\150\157\167 minimap","l\155\155"),"\155inimap_\150\151\144e" => __("\110\151\144e minima\160","\154\155\155"),"fullsc\162\145\145n_button\137\164\151tle" => __("View ful\154\163\143reen","lmm"),"fullscree\156\137\142utton_ti\164\154\145_exit" => __("\105xit full\163\143\162een","lmm"),"\146ullscree\156\137\142utton_p\157\163\151tion" => esc_js($l4["m\141\160\137fullscr\145\145\156_button\137\160\157sition"]),"\155axzoom" => intval($l4["\147lobal_\155\141\170zoom_lev\145\154"]),"met\145\162\163" => __("\155\145\164ers","lmm"),"\146eet" => __("feet","lmm"),"\147px_ico\156\163\137status" => esc_js($l4["\147\160\170_icons\137\163\164atus"]))); wp_localize_script("leaf\154\145\164mapsmark\145\162\055addon\163","lmm_ajax_\166\141\162s",array("lmm_aja\170\137\156once" => wp_create_nonce("\154\155\155-ajax-n\157\156\143e"),"\154\155\155_ajax_l\145\141\146let_plu\147\151\156_url" => O1,"lmm_a\152\141\170_text_no\137\162\145sults_f\157\165\156d" => __("\116\157\040matches\040\146\157und","lmm"),"lmm_aj\141\170\137url" => admin_url("\141\144min-ajax\056\160\150p"))); } function lmm_admin_enqueue_scripts() { global $wp_version,$locale; $l4=get_option("\154\145afletmap\163\155\141rker_o\160\164\151ons"); $O4=get_option("\154\145\141fletmap\163ma\162\153\145r_versi\157\156\137pro"); wp_enqueue_script(array("\152\161uery")); $page=( isset ($_GET["\160age"]) ? $_GET["\160\141\147e"]: ""); if ($page == "\154eaflet\155\141\160smarker\137\154\141yer") { if (version_compare($wp_version,"\063\0565","\076=")) { wp_enqueue_media(); } else { wp_enqueue_style("\164\150\151ckbox"); wp_enqueue_script("media-up\154\157\141d"); wp_enqueue_script("t\150\151\143kbox"); wp_enqueue_script("media-m\157\144\145ls"); } } wp_enqueue_script("\154\145afletmap\163\155\141rker-a\165\164\157complet\145\055\154oader",O1."inc/js/\141\165\164ocomple\164\145\056jquery\056\155\151n.js",array("\152\161\165ery"),$O4); wp_enqueue_script("leaflet\155\141\160smarker-\147\145\157coding-\154\157\141der",O1."\151\156\143/js/ge\157\143\157ding.js",array("\152\161uery"),$O4); if ($l4["\147\157ogle_map\163\137\141pi_sta\164\165\163"] == "\144isabled" || $l4["goog\154\145\137maps_api\137\144\145ferred_\154\157\141ding"] == "enab\154\145\144") { wp_enqueue_script("\154\145afletmap\163\155\141rker-co\162\145",O1."leafle\164\055\144ist/lea\146\154\145t-core.\152\163",array(),$O4,FALSE); wp_enqueue_script("\154\145\141fletma\160\163\155arker-a\144\144\157ns",O1."leafl\145\164\055dist/le\141\146\154et-addo\156\163\056js",array("\154eaflet\155\141\160smarker\055\143\157re"),$O4,FALSE); } else { if ( isset ($l4["goo\147\154\145_maps_a\160\151\137key"]) && ($l4["google_\155\141\160s_api_k\145\171"] != NULL)) { $google_maps_api_key="?k\145\171\075".esc_js(trim($l4["goog\154\145\137maps_ap\151\137\153ey"])); } else { $google_maps_api_key=""; } wp_enqueue_script("\154\145afletma\160\163\155arker-g\157\157\147lemaps-\154\157\141der","https\072\057\057www.go\157\147\154e.com/js\141\160\151".$google_maps_api_key,array(),NULL,TRUE); wp_enqueue_script("\154\145\141fletmaps\155\141\162ker-cor\145",O1."\154eaflet-d\151\163\164/leaflet\055\143\157re.js",array("leafle\164\155\141psmarke\162\055\147ooglema\160\163\055loader"),$O4,FALSE); wp_enqueue_script("\154\145\141fletma\160\163\155arker-ad\144\157\156s",O1."leafl\145\164\055dist/le\141\146\154et-add\157\156\163.js",array("\154eafletmap\163\155\141rker-co\162\145"),$O4,FALSE); } if ($l4["mapques\164\137\141pi_key"] != NULL) { wp_enqueue_script("\154\145afletma\160\163\155arker-\155\141\160quest","\150ttps://w\167\167\056mapque\163\164\141pi.com/s\144\153\057leafl\145\164\057v2.2/m\161\055\155ap.js\077\153\145y=".esc_js(trim($l4["mapquest\137\141\160i_key"])),array("leafletm\141\160\163marker-\143\157\162e"),NULL,FALSE); } if ($l4["g\157\157\147le_maps\137\154\141nguage_\154\157\143alizat\151\157\156"] == "br\157\167\163er_setti\156\147") { $google_language=""; } else if ($l4["g\157\157gle_ma\160\163\137lang\165\141\147e_loc\141\154\151zatio\156"] == "\167\157\162dpress\137\163\145tting") { if ($locale != NULL) { $google_language="&la\156\147\165age=".substr($locale,0,2); } else { $google_language="\046language\075\145n"; } } else { $google_language="&language\075".esc_html($l4["\147oogle_\155\141\160s_lang\165\141\147e_loca\154\151\172ation"]); } if ($l4["go\157\147\154e_maps\137\142\141se_doma\151\156\137custom"] != "") { $gmaps_base_domain="\046\142ase_doma\151\156\075".esc_html($l4["go\157\147le_maps\137\142\141se_dom\141\151\156"]); } else { $gmaps_base_domain="&bas\145\137\144omain=".esc_html($l4["google_\155\141\160s_base_d\157\155\141in_cust\157\155"]); } $google_styling_json=($l4["\147\157ogle_sty\154\151\156g_json"] == NULL) ? "\144\151\163abled": str_replace("\042","'",$l4["goog\154\145\137styling\137\152\163\157\156"]); if ($l4["bingma\160\163\137cultur\145"] == "automati\143") { if ($locale != NULL) { $bing_culture=str_replace("\137","\055",$locale); } else { $bing_culture="\145\156_us"; } } else { $bing_culture=$l4["\142ingmaps_\143\165\154ture"]; } wp_localize_script("leafl\145\164\155apsmarke\162\055\143ore","\155\141\160smarker\152\163\160ro",array("z\157\157\155_in" => __("\132\157\157m in","lmm"),"zoom_ou\164" => __("Z\157\157\155 out","lmm"),"google_\155\141\160s_api_st\141\164\165s" => esc_js($l4["\147oogle_ma\160\163\137api_st\141\164\165s"]),"\147\157\157gle_ma\160\163\137plugin" => esc_js($l4["\147oogle_map\163\137\160lugin"]),"g\157\157\147le_defer\162\145\144_loading" => esc_js($l4["goog\154\145\137maps_ap\151\137\144eferred\137\154\157ading"]),"\147ooglemaps\137\154\141nguage" => $google_language,"g\157\157\147lemaps_b\141\163\145_domain" => $gmaps_base_domain,"\147oogle_\155\141\160s_api_ke\171" => esc_js(trim($l4["\147oogle\137\155\141ps_api_k\145\171"])),"\147\157\157gle_styl\151\156\147_json" => $google_styling_json,"\142ing_cultu\162\145" => $bing_culture,"\155\151\156imap_sh\157\167" => __("\123\150ow minim\141\160","\154mm"),"\155\151nimap_\150\151\144e" => __("Hide mi\156\151\155ap","\154mm"),"\146ullscre\145\156\137button_t\151\164\154e" => __("View ful\154\163\143reen","lmm"),"fullscre\145\156\137button_t\151\164\154e_exit" => __("\105\170\151t fulls\143\162\145en","lm\155"),"\146\165\154lscree\156\137\142utton_po\163\151\164ion" => esc_js($l4["map_fu\154\154\163creen_b\165\164\164on_posi\164\151\157n"]),"\155\141\170zoom" => intval($l4["\147\154\157bal_ma\170\172\157om_leve\154"]),"\155eters" => __("\155\145ters","lmm"),"feet" => __("\146\145et","\154\155m"),"\147px_icon\163\137\163tatus" => esc_js($l4["gpx_icon\163\137\163tatus"]))); } function lmm_frontend_enqueue_stylesheets() { $l4=get_option("\154eafletma\160\163\155arker_o\160\164\151ons"); global $wp_query; $posts=$wp_query->posts; $pattern=get_shortcode_regex(); $O4=get_option("lea\146\154\145tmapsma\162\153\145r_vers\151\157\156_pro"); if (function_exists("is_rt\154") && is_rtl()) { $lq="\154\145afletma\160\163\155arker-\162\164\154"; $Oq="lea\146\154\145t-rtl.m\151\156\056css"; } else { $lq="\154\145afletma\160\163\155arker"; $Oq="\154eaflet\056\155\151n.css"; } wp_register_style($lq,O1."le\141\146\154et-dist\057".$Oq,array(),$O4); if (is_array($posts)) { foreach ($posts as $post) { if (preg_match_all("\057".$pattern."\057s",$post->post_content ,$matches) && array_key_exists(2,$matches) && in_array($l4["\163hortcode"],$matches[2])) { wp_enqueue_style($lq); break; } } $lmm_custom_css="\056leafle\164\055\160opup-c\157\156\164ent im\147\040\173 ".htmlspecialchars($l4["defaul\164\163\137marker_\160\157\160ups_im\141\147\145_css"])." } .mark\145\162\055cluster\055\163\155all \173\040\142ackgrou\156\144\055colo\162\072\040".htmlspecialchars($l4["\143\154usterin\147\137\143olor_sm\141\154\154"]).";\040\175\040.marke\162\055\143luster\055\163\155all di\166\040\173 back\147\162\157und-c\157\154\157r: ".htmlspecialchars($l4["clus\164\145\162ing_col\157\162\137small_i\156\156\145r"])."\073\040color: ".htmlspecialchars($l4["\143\154\165stering\137\143\157lor_sma\154\154\137text"])."\073\040} .mark\145\162\055cluste\162\055\155edium \173\040\142ackgr\157\165\156d-colo\162\072\040".htmlspecialchars($l4["\143\154ustering\137\143\157lor_med\151\165\155"])."; }\040\056\155arker\055\143\154uster-\155\145\144ium di\166\040\173 bac\153\147\162ound-c\157\154\157r: ".htmlspecialchars($l4["\143lusterin\147\137\143olor_me\144\151\165m_inner"])."\073\040 color: ".htmlspecialchars($l4["clus\164\145\162ing_col\157\162\137medium\137\164\145xt"])."\073\040\175 .mark\145\162\055cluste\162\055\154arge \173\040\142ackgr\157\165\156d-colo\162\072\040".htmlspecialchars($l4["\143\154ustering\137\143\157lor_l\141\162\147e"])."; } .\155\141\162ker-clu\163\164\145r-large\040\144\151v \173 \142\141\143kgrou\156\144\055color\072\040".htmlspecialchars($l4["clus\164\145\162ing_col\157\162\137large_i\156\156\145r"]).";  \143\157\154or: ".htmlspecialchars($l4["cluster\151\156\147_color_\154\141\162ge_text"])."\073\040}"; wp_add_inline_style($lq,$lmm_custom_css); } } function lmm_template_check_shortcode($template) { $l4=get_option("\154eafletma\160\163\155arker_\157\160\164ions"); $searchterm="\133".$l4["shor\164\143\157de"]; $files=array($template,get_stylesheet_directory().DIRECTORY_SEPARATOR."he\141\144\145r.php",get_stylesheet_directory().DIRECTORY_SEPARATOR."foote\162\056\160hp"); if (function_exists("is_\162\164\154") && is_rtl()) { $lq="\154\145afletma\160\163\155arker-\162\164\154"; $Oq="\154eaflet-\162\164\154.min.c\163\163"; } else { $lq="lea\146\154\145tmapsma\162\153\145r"; $Oq="\154\145aflet.\155\151\156.css"; } foreach ($files as $file) { if (file_exists($file)) { $contents=file_get_contents($file); if (strpos($contents,$searchterm)) { $O4=get_option("\154eafletma\160\163\155arker_\166\145\162sion_p\162\157"); wp_register_style($lq,O1."\154\145\141flet-di\163\164\057".$Oq,array(),$O4); wp_enqueue_style($lq); break; } } } return $template; } function lmm_admin_enqueue_stylesheets() { $O4=get_option("\154\145\141fletma\160\163\155arker_\166\145\162sion_pr\157"); if (function_exists("i\163\137\162tl") && is_rtl()) { wp_register_style("leaflet\155\141\160smarker\055\141\144min-rt\154",O1."inc/cs\163\057\154eaflet\155\141\160smarker\055\141\144min-r\164\154\056css",array(),$O4); wp_enqueue_style("leafle\164\155\141psmarke\162\055\141dmin-\162\164\154"); } else { wp_register_style("lea\146\154\145tmapsma\162\153\145r-admi\156",O1."inc/css/\154\145\141fletma\160\163\155arker-\141\144\155in.css",array(),$O4); wp_enqueue_style("leafle\164\155\141psmarke\162\055\141dmin"); } } function lmm_admin_enqueue_stylesheets_leaflet() { global $wp_version; $O4=get_option("le\141\146\154etmapsm\141\162\153er_vers\151\157\156_pro"); if (function_exists("\151s_rtl") && is_rtl()) { $lq="\154eafle\164\155\141psmarke\162\055\162tl"; $Oq="leafle\164\055\162tl.min\056\143\163s"; } else { $lq="le\141\146\154etmapsm\141\162\153er"; $Oq="\154\145\141flet.m\151\156\056css"; } wp_register_style($lq,O1."leaflet\055\144\151st/".$Oq,array(),$O4); wp_enqueue_style($lq); if (version_compare($wp_version,"\063.7",">=")) { $l4=get_option("\154\145afletm\141\160\163marker\137\157\160tions"); $lmm_custom_css=".\154\145\141flet-po\160\165\160-conten\164\040\151mg \173\040".htmlspecialchars($l4["defaults\137\155\141rker_p\157\160\165ps_imag\145\137\143ss"])."\040\175 .mark\145\162\055clust\145\162\055small \173\040\142ackgr\157\165\156d-colo\162\072 ".htmlspecialchars($l4["cl\165\163\164ering_c\157\154\157r_small"])."\073\040} .mar\153\145\162-clust\145\162\055small \144\151\166 \173 b\141\143\153ground\055\143\157lor: ".htmlspecialchars($l4["cluste\162\151\156g_color\137\163\155all_inn\145\162"])."; col\157\162\072 ".htmlspecialchars($l4["clus\164\145\162ing_col\157\162\137small_t\145\170\164"])."; } \056\155\141rker-c\154\165\163ter-me\144\151\165m \173 b\141\143\153groun\144\055\143olor:\040".htmlspecialchars($l4["clust\145\162\151ng_color\137\155\145dium"])."; \175\040\056marker\055\143\154uster-m\145\144\151um div \173\040backgro\165\156\144-color\072\040".htmlspecialchars($l4["cluster\151\156\147_color_m\145\144\151um_inne\162"])."\073 color\072\040".htmlspecialchars($l4["\143\154\165stering\137\143\157lor_med\151\165\155_text"])."\073\040} .mar\153\145\162-clust\145\162\055large \173\040\142ackgr\157\165\156d-colo\162\072\040".htmlspecialchars($l4["clusteri\156\147\137color_l\141\162\147e"])."; } .\155\141\162ker-clu\163\164\145r-large\040\144\151v \173 \142\141\143kgroun\144\055color: ".htmlspecialchars($l4["c\154\165\163tering_\143\157\154or_lar\147\145\137inner"])."\073\040\143olor:\040".htmlspecialchars($l4["\143\154ustering\137\143\157lor_la\162\147\145_text"])."\073\040}"; wp_add_inline_style($lq,$lmm_custom_css); } } function lmm_admin_enqueue_stylesheets_adminbar() { $l4=get_option("leaflet\155\141\160smarke\162\137\157ptions"); if ($l4["ad\155\151\156_bar_in\164\145\147ration"] == "e\156\141\142led" && current_user_can($l4["capabilit\151\145\163_view_o\164\150\145rs"])) { $O4=get_option("lea\146\154\145tmapsma\162\153\145r_versi\157\156\137pro"); wp_register_style("\154eaflet\155\141\160smarker\055\141\144min-a\144\155\151nbar",O1."inc/css/l\145\141\146letmaps\155\141\162ker-adm\151\156\055admin\142\141\162.css",array(),$O4); wp_enqueue_style("leaf\154\145\164mapsmar\153\145\162-admin-\141\144\155inbar"); } } function lmm_install_and_updates() { $current_version="vp311"; $schedule_transient="leaf\154\145\164mapsmar\153\145\162_install\137\165\160date_c\141\143\150e_".$current_version; $install_update_schedule=get_transient($schedule_transient); if ($install_update_schedule === FALSE) { $schedule_transient="leaflet\155\141\160smarker\137\151\156stall_u\160\144\141te_cac\150\145\137".$current_version; set_transient($schedule_transient,"\145\170ecute in\163\164\141ll and \165\160\144ate-rou\164\151\156e only\040\157nce a d\141\171",074*074*030); include ("inc".DIRECTORY_SEPARATOR."inst\141\154\154-and-up\144\141\164es.php"); } } function lmm_plugin_meta_links() { define( "FB_BASENAME" ,plugin_basename( __FILE__)); define( "FB_BASEFOLDER" ,plugin_basename(dirname( __FILE__))); define( "FB_FILENAME" ,str_replace(FB_BASEFOLDER."\057","",plugin_basename( __FILE__))); function leafletmapsmarker_filter_plugin_meta($links,$file) { if ($file == FB_BASENAME) { array_unshift($links,"<a href\075\042".l1."\141\144min.php?\160\141\147e=leafl\145\164\155apsmark\145\162_marker\163\042\076".__("Ma\162\153\145rs","\154mm")."\074/a>","<a\040\150\162ef=\042".l1."ad\155\151\156.php?pag\145\075\154eaflet\155\141\160smarke\162\137\154ayers\042\076".__("\114ayers","lmm")."\074/a>","<a h\162\145\146=\042".l1."admin.p\150\160\077page=le\141\146\154etmapsma\162\153\145r_set\164\151\156gs\042>".__("S\145\164\164ings","lmm")."\074\057a>","<\141\040\150ref=\042".l1."admin.\160\150\160?page=le\141\146\154etmaps\155\141\162ker_lic\145\156\163e\042>".__("\114\151\143ense","lmm")."\074/a>"); } return $links; } add_filter("plugin\137\141\143tion_li\156\153\163","leafl\145\164\155apsmarke\162\137\146ilter_pl\165\147\151n_meta",012,2); } function lmm_add_kml_to_sitemap() { if (class_exists("Google\123\151\164emapGene\162\141\164or")) { global $wpdb; $table_name_markers=$wpdb->prefix."\154\145\141fletmap\163\155\141rker_ma\162\153\145rs"; $lr=$wpdb->prefix."\154eafletmap\163\155\141rker_la\171\145\162s"; $l4=get_option("\154eafletmap\163\155\141rker_o\160\164\151ons"); $sitemap=googlesitemapgenerator::getinstance(); if (($l4["\170\155\154_sitem\141\160\163_includ\145"] == "\142\157\164h") || ($l4["xml_sitem\141\160\163_includ\145"] == "ma\162\153\145rs")) { $ls="SEL\105\103\124 m.id as\040\155\151d, m.\143\162\145atedon \141\163\040mcreat\145\144\157n, m.u\160\144\141tedon \141\163\040mupda\164\145\144on F\122\117\115 `".$table_name_markers."\140\040AS m"; if ($l4["\170\155\154_sitema\160\163\137exclude\137\155\141rkers"] != NULL) { if (preg_match("/^\134\144\050\077:,\134\144\051\052\044/",str_replace("\054 ","\054",trim($l4["\170\155\154_sitem\141\160\163_exclud\145\137\155arkers"]))) == TRUE) { $ls.="\040WHERE m.i\144\040\116OT IN \050".str_replace(", ",",",trim($l4["\170ml_sit\145\155\141ps_exclu\144\145\137markers"])).")"; } } $Os=$wpdb->get_results($ls,ARRAY_A); foreach ($Os as $lt) { if (($lt["mupdat\145\144\157n"] == NULL) || ($lt["m\165\160\144atedon"] == "\060000-00\055\060\060 00:00\072\060\060")) { $Ot=strtotime($lt["mcreat\145\144\157n"]); } else { $Ot=strtotime($lt["\155updated\157\156"]); } $sitemap->addurl(mmp_globals::translate_permalink(mmp_rewrite::get_base_url().mmp_rewrite::get_slug()."\057\153ml/marke\162\057".$lt["\155\151d"]."\057"),$Ot,$l4["\170ml_sitem\141\160\163_chang\145\137\146requency\137\155\141rkers"],$l4["xml_\163\151\164emaps_p\162\151\157rity_mar\153\145\162s"]); } } if (($l4["x\155\154\137sitemap\163\137\151nclude"] == "both") || ($l4["\170ml_sitem\141\160\163_includ\145"] == "laye\162\163")) { $lu="\123ELECT l.\151\144\040as lid,\040\154\056create\144\157\156 as lc\162\145\141tedon,\040\154\056updat\145\144\157n as \154\165\160dated\157\156\040FROM \140".$lr."\140\040AS l WH\105\122\105 l.id !\075\040\060"; if ($l4["\170\155l_sitem\141\160\163_exclud\145\137\154ayers"] != NULL) { if (preg_match("/^\134d(?:\054\134\144)*\044/",str_replace("\054 ","\054",trim($l4["\170\155l_sitema\160\163\137exclud\145\137\154ayers"]))) == TRUE) { $lu.=" AND\040\154\056id NOT\040\111\116 (".str_replace("\054 ","\054",trim($l4["\170\155\154_sitemap\163\137\145xclude_\154\141\171ers"])).")"; } } $Ou=$wpdb->get_results($lu,ARRAY_A); foreach ($Ou as $lv) { if (($lv["lupdat\145\144\157n"] == NULL) || ($lv["lupda\164\145\144on"] == "\060\06000-00-00\040\060\060:00:0\060")) { $Ot=strtotime($lv["\154\143\162eatedo\156"]); } else { $Ot=strtotime($lv["\154\165pdatedon"]); } $sitemap->addurl(mmp_globals::translate_permalink(mmp_rewrite::get_base_url().mmp_rewrite::get_slug()."\057\153ml/layer\057".$lv["\154\151d"]."\057"),$Ot,$l4["xml_sit\145\155\141ps_chan\147\145\137frequen\143\171\137layers"],$l4["\170ml_sitema\160\163\137priority\137\154\141yers"]); } } } } } if (is_admin()) { $ln= isset ($_GET["\160\141ge"]) ? $_GET["page"]: ""; $Ov=array("leafletm\141\160\163marker_\155\141\162kers","\154\145afletmap\163\155\141rker_mar\153\145\162","leafl\145\164\155apsmarke\162\137\151mport_e\170\160\157rt","\154\145afletma\160\163\155arker_l\141\171\145rs","le\141\146\154etmapsma\162\153\145r_layer","\154\145\141fletmap\163\155\141rker_too\154\163","leafle\164\155\141psmarker\137\163\145ttings"); if ((in_array($ln,$Ov)) && (O3() === FALSE)) { if (lw() !== TRUE) { exit (header("Locatio\156\072\040".l1."admin.ph\160\077\160age=le\141\146\154etmapsm\141\162\153er_lic\145\156\163e")); } if (la($Oa=O0,$lb=FALSE) === FALSE) { $Ow=array("\154eafletmap\163\155\141rker_ma\162\153\145rs","le\141\146\154etmapsma\162\153\145r_marke\162","\154eafletm\141\160\163marker_\151\155\160ort_exp\157\162\164","\154\145\141fletmaps\155\141\162ker_laye\162\163","leafletma\160\163\155arker_la\171\145\162","leafle\164\155\141psmarker\137\164\157ols","leaf\154\145\164mapsmark\145\162\137setting\163","\154eafletma\160\163\155arker_a\160\151\163"); if (in_array($ln,$Ow)) { echo "\074script \164\171\160e=\042t\145\170\164/javasc\162\151\160t\042>w\151\156\144ow.loc\141\164\151on.hr\145\146\040= \042".l1."\141dmin.ph\160\077\160age=lea\146\154\145tmapsm\141\162\153er_lic\145\156\163e&error\075\154e\042;</\163\143\162ipt>  "; } } } } function lx($Ox,$is_theme=FALSE) { $ly=""; if ( isset ($_GET["page"])) { $ly=$_GET["\160age"]; } elseif ( isset ($_POST["\160\141\147e"])) { $ly=$_POST["\160\141ge"]; } $Oy=in_array($ly,$Ox); if ($is_theme) { return $Oy; } $lz=in_array(plugin_basename( __FILE__),get_option("ac\164\151\166e_plug\151\156\163")); return ($Oy && $lz); } function lw($Oz=FALSE) { $spbas=new l10; $spbas->O10 ="datab\141\163\145"; $spbas->l11 =array("\154\157cal_key" => get_option("\154\145afletmap\163\155\141rkerpro_\154\151\143ense_lo\143\141\154_key")); $spbas->O11 =array("f\165\156\143tion" => "updat\145\137\157ption","\153\145y" => "\154\145afletma\160\163\155arkerp\162\157\137license\137\154\157cal_key"); $spbas->l12 ="\061,2,3,4\054\065\0546,7,8\054\071\05410"; $spbas->O12 =get_option("leaf\154\145\164mapsmar\153\145\162pro_lic\145\156\163e_key"); $spbas->l13 ="\067\143\14199e156\142\065\14530e06\064\070\14649b8117\070\143\1447e"; $spbas->O13 ="https://\167\167\167.mapsmar\153\145\162.com/st\157re/ap\151\057index.p\150p"; $spbas->validate(); if ($Oz) { return $spbas; } $Ox=array("l\145\141\146letmap\163\155\141rker_ma\162\153\145rs","\154\145\141fletmap\163\155\141rker_mar\153\145\162","le\141\146\154etmapsma\162\153\145r_impor\164\137\145xport","\154\145afletma\160\163\155arker_\154\141\171ers","l\145\141\146letmapsm\141\162\153er_laye\162","\154\145afletmap\163\155\141rker_t\157\157\154s","leaf\154\145\164mapsmarke\162\137\163ettings"); if (is_admin() && lx($Ox,TRUE) && $spbas->l14) { return $spbas->l14; } return TRUE; } function la($Oa=FALSE,$lb=FALSE) { $spbas=new l10; if ($Oa !== FALSE) { $spbas->Oa =strrev(substr($Oa,1,012)); } $spbas->O10 ="\144\141\164abase"; $spbas->l11 =array("\154\157\143al_key" => get_option("lea\146\154\145tmapsm\141\162\153erpro_l\151\143\145nse_lo\143\141\154_key")); $spbas->O11 =array("\146\165\156ction" => "up\144\141\164e_optio\156","ke\171" => "lea\146\154\145tmapsmar\153\145\162pro_lic\145\156\163e_local_\153\145\171"); $spbas->l12 ="\061,2,3,4\054\065\0546,7,8,\071\054\0610"; $spbas->O12 =get_option("l\145\141\146letmapsm\141\162\153erpro_l\151\143\145nse_key"); $spbas->l13 ="7ca99e\061\065\066b5e30\145\060\06648f49b\070\061\06178cd7e"; $spbas->O13 ="http\163\072\057/www.m\141\160\163marker.\143\157\155/store/\141\160\151/index.\160\150\160"; $spbas->validate(); if ($lb !== FALSE) { if ($spbas->l14) { return FALSE; } else { return TRUE; } } if ($spbas->l14) { return FALSE; } if ($Oa === FALSE) { $O14=$spbas->l15["do\167\156\154oad_acc\145\163\163_expir\145\163"]; $O15=$spbas->l15["suppo\162\164\137access_\145\170\160ires"]; $l16=abs(($O14>$O15) ? $O14: $O15); if (!O16()) { if ($spbas->l15["licen\163\145\137expires"] == "never") { return FALSE; } if (time()>$spbas->l15["\154\151\143ense_e\170\160\151res"]) { return FALSE; } return TRUE; } return ($l16>time()) ? TRUE: FALSE; } else if ($Oa !== FALSE) { $O14=$spbas->l15["do\167\156\154oad_acc\145\163\163_expire\163"]; $O15=$spbas->l15["support_a\143\143\145ss_exp\151\162\145s"]; $l16=abs(($O14>$O15) ? $O14: $O15); if (!O16()) { if ($spbas->l15["license_\145\170\160ires"] == "\156ever") { return FALSE; } if (time()>$spbas->l15["lice\156\163\145_expire\163"]) { return FALSE; } return TRUE; } if ($spbas->Oa >$l16) { return FALSE; } else { return TRUE; } } } function lmm_validate_license_info($release_date_info=FALSE,$license_only_info=FALSE) { $spbas_info=new l10; if ($release_date_info !== FALSE) { $spbas_info->release_date_info =strrev(substr($release_date_info,1,012)); } $spbas_info->O10 ="database"; $spbas_info->l11 =array("\154\157\143al_key" => get_option("l\145\141\146letmaps\155\141\162kerpro_\154\151\143ense_lo\143\141\154_key")); $spbas_info->O11 =array("fun\143\164\151on" => "update_op\164\151\157n","\153\145\171" => "\154\145afletma\160\163\155arkerp\162\157\137licens\145\137\154ocal_ke\171"); $spbas_info->l12 ="\061,2,3,4,5,\066\0547,8,9,10"; $spbas_info->O12 =get_option("\154\145\141fletma\160\163\155arkerpr\157\137\154icense_\153\145\171"); $spbas_info->l13 ="\067ca99e1\065\066\1425e30e0\066\0648f49b811\067\070\143d7e"; $spbas_info->O13 ="https\072\057\057www.m\141\160\163marker.\143\157\155/store/\141\160\151/index\056\160\150p"; $spbas_info->validate(); if ($license_only_info !== FALSE) { if ($spbas_info->l14) { return FALSE; } else { return TRUE; } } if ($spbas_info->l14) { return FALSE; } if ($release_date_info === FALSE) { $download_expires_info=$spbas_info->l15["\144ownloa\144\137\141ccess_ex\160\151\162es"]; $support_expires_info=$spbas_info->l15["support\137\141\143cess_ex\160\151\162es"]; $expires_info=abs(($download_expires_info>$support_expires_info) ? $download_expires_info: $support_expires_info); if (!O16()) { if ($spbas_info->l15["lic\145\156\163e_expir\145\163"] == "\156\145\166er") { return FALSE; } if (time()>$spbas_info->l15["\154icense_ex\160\151\162es"]) { return FALSE; } return TRUE; } return ($expires_info>time()) ? TRUE: FALSE; } else if ($release_date_info !== FALSE) { $download_expires_info=$spbas_info->l15["\144ownload_a\143\143\145ss_exp\151\162\145s"]; $support_expires_info=$spbas_info->l15["\163\165pport_ac\143\145\163s_expi\162\145\163"]; $expires_info=abs(($download_expires_info>$support_expires_info) ? $download_expires_info: $support_expires_info); if (!O16()) { if ($spbas_info->l15["l\151\143\145nse_exp\151\162\145s"] == "\156ever") { return FALSE; } if (time()>$spbas_info->l15["l\151\143\145nse_exp\151\162\145s"]) { return FALSE; } return TRUE; } if ($spbas_info->Oa >$expires_info) { return FALSE; } else { return TRUE; } } } function O16($prefix="M\141\160\163MarkerP\162\157\055") { return substr(get_option("leafle\164\155\141psmarke\162\160\162o_lice\156\163\145_key"),0,strlen($prefix)) == $prefix; } function lmm_pro_version_info($prefix="\115\141psMarke\162\120\162o-") { return substr(get_option("leaflet\155\141\160smarker\160\162\157_licens\145\137\153ey"),0,strlen($prefix)) == $prefix; } function l17($prefix="\115apsMarke\162\120\162o-5P-") { return substr(get_option("leaf\154\145\164mapsmar\153\145\162pro_lic\145\156\163e_key"),0,strlen($prefix)) == $prefix; } function O17($prefix="\115apsMarker\120\162\157-25P-") { return substr(get_option("leafletm\141\160\163markerp\162\157\137license\137\153\145y"),0,strlen($prefix)) == $prefix; } function l18($prefix="M\141\160\163MarkerP\162\157\055100P-") { return substr(get_option("lea\146\154\145tmapsma\162\153\145rpro_l\151\143\145nse_ke\171"),0,strlen($prefix)) == $prefix; } function O18($prefix="Ma\160\163\115arkerPr\157\055\06250P-") { return substr(get_option("leaf\154\145\164mapsmar\153\145\162pro_lic\145\156\163e_key"),0,strlen($prefix)) == $prefix; } function l19($prefix="MapsMarke\162\120\162o-500P-") { return substr(get_option("leafl\145\164\155apsmark\145\162\160ro_lice\156\163\145_key"),0,strlen($prefix)) == $prefix; } function O19($prefix="\115\141psMarker\120\162\157-1000P-") { return substr(get_option("leafle\164\155\141psmarke\162\160\162o_licen\163\145\137key"),0,strlen($prefix)) == $prefix; } function l1a($attribute) { if ( isset ($_POST[$attribute]) && ($_POST[$attribute] == TRUE)) { return $_POST[$attribute]; } global $current_user; wp_get_current_user(); switch ($attribute) { case "\155aps_marke\162\137\160ro_fir\163\164\137name": return $current_user->user_firstname; case "\155\141\160s_mark\145\162\137pro_las\164\137\156ame": return $current_user->user_lastname; case "\155aps_mar\153\145\162_pro_ema\151\154": return $current_user->user_email; } return ""; } function maps_marker_pro_license_activation_page() { if (!function_exists("\167p_veri\146\171\137nonce")) { require_once (ABSPATH."\167\160-include\163".DIRECTORY_SEPARATOR."\160\154uggable.\160\150\160"); } if ( isset ($_POST["\155aps_mark\145\162\137pro_reg\151\163\164er_free"])) { if (wp_verify_nonce($_POST["\155\141ps_marke\162\137\160ro_regi\163\164\145r_free_\146\157\162m_non\143\145"],"ma\160\163\137marker_p\162\157\137regist\145\162\137free_f\157\162\155_nonce")) { $spbas=new l10; $O1a=""; $l1b=array(); if (!$_POST["map\163\137\155arker_p\162\157\137first_\156\141\155e"]) { $l1b[]=__("\120\154ease ent\145\162\040your f\151\162\163t name \164\157\040contin\165\145\056","lmm"); } if (!$_POST["maps\137\155\141rker_pr\157\137\154ast_nam\145"]) { $l1b[]=__("Ple\141\163\145 enter \171\157\165r last \156\141\155e to c\157\156\164inue.","lmm"); } if (!$_POST["m\141\160\163_marker_\160\162\157_email"]) { $l1b[]=__("P\154\145\141se ente\162\040\171our ema\151\154\040to con\164\151\156ue.","lmm"); } if (sanitize_email($_POST["\155aps_mar\153\145\162_pro_em\141\151\154"]) !== $_POST["map\163\137\155arker_p\162\157\137email"]) { $l1b[]=__("Please \145\156\164er a va\154\151\144 email \164\157\040conti\156\165\145 (or g\145\164\040\141n anony\155\157\165s tri\141\154\040lice\156\163\145 key)","\154mm"); } if (!$_POST["\155\141ps_marke\162\137\160ro_tos"]) { $l1b[]=__("\131\157u must \141\147\162ee to t\150\145\040TOS to\040\143\157ntinue\056","\154\155m"); } if (empty($l1b)) { $qs="mod=\063\162\144_party\046\164\141\163k=api&ap\151\137\153ey=50\141\062\0609431\064\146\142c82e7\061\062\1423f9b21f00\067\0645&ema\151\154\075".urlencode(sanitize_email($_POST["maps_\155\141\162ker_pro\137em\141\151\154"]))."&fi\162\163\164_name=".urlencode(sanitize_text_field($_POST["maps_mark\145\162\137pro_fir\163\164\137name"]))."&last_na\155\145\075".urlencode(sanitize_text_field($_POST["maps_mar\153\145\162_pro_la\163\164\137name"]))."&company\137\156\141me=".urlencode(sanitize_text_field($_POST["\155aps_mar\153\145\162_pro_fi\162\163\164_name"]))."%20".urlencode(sanitize_text_field($_POST["\155\141\160s_marker\137\160\162o_last\137\156\141me"]))."\046userna\155\145\075".strtolower(sanitize_user($_POST["m\141\160\163_marker\137\160\162o_last_n\141\155\145"],TRUE).substr(sanitize_user($_POST["\155aps_mark\145\162\137pro_fir\163\164\137name"],TRUE),0,1)); $O1b=$spbas->l1c("\150\164\164ps://ww\167\056\155apsmar\153\145\162.com/s\164\157\162e/api/\151\156\144ex.php",$qs); if (strtolower(substr($O1b,0,021)) == "\143\157nnecti\157\156\040error:") { $l1b[]=$O1b; } else if (strtolower(substr($O1b,0,5)) == "\145\162\162or") { $l1b[]=$O1b; } else { $O1b=json_decode($O1b); update_option("leafle\164\155\141psmarke\162\160\162o_licen\163\145\137key",$spbas->O12 =$O1b[0]); update_option("leafletm\141\160\163marker\160\162\157_licen\163\145\137local_\153\145\171",""); update_option("leaflet\155\141\160smarker\160\162\157_licens\145\137\153ey_tr\151\141\154",$spbas->O12 =$O1b[0]); $O1a=__("Your ne\167\040\154icens\145\040\167as reg\151\163\164ered s\165\143\143essfu\154\154\171!","\154\155\155"); } } } else { $l1b[]=__("\123\145\143urity c\150\145\143k fail\145\144\040- ple\141\163\145 call\040\164\150is fu\156\143\164ion f\162\157\155 the \141\143\143ordi\156\147\040admi\156\040\160age!","lmm"); } } else if ( isset ($_POST["\155\141\160s_mar\153\145\162_pro_re\147\151\163ter_fr\145\145\137anonym"])) { if (wp_verify_nonce($_POST["\155\141ps_mark\145\162\137pro_re\147\151\163ter_fre\145\137\141nonym_\146\157\162m_non\143\145"],"\155aps_mar\153\145\162_pro_re\147\151\163ter_fr\145\145\137anonym_\146\157\162m_non\143\145")) { $spbas=new l10; $O1a=""; $l1b=array(); if (!$_POST["\155aps_mark\145\162\137pro_tos"]) { $l1b[]=__("\131\157\165 must \141\147\162ee to t\150\145\040TOS t\157\040\143ontin\165\145\056","lmm"); } if (empty($l1b)) { $qs="\155od=3rd_\160\141\162ty&task\075\141\160i&api\137\153\145y=f8b3\067\070\062fef2\065\143\063f68e8\060\071f621d19\063\06063"; $O1b=$spbas->l1c("https:/\057\167\167w.maps\155\141\162ker.co\155\057\163tore/a\160\151\057index\056\160\150p",$qs); if (strtolower(substr($O1b,0,021)) == "con\156\145\143tion er\162\157\162:") { $l1b[]=$O1b; } else if (strtolower(substr($O1b,0,5)) == "error") { $l1b[]=$O1b; } else { $O1b=json_decode($O1b); update_option("\154\145\141fletma\160\163\155arkerpr\157\137\154icense_\153\145\171",$spbas->O12 =$O1b[0]); update_option("leaflet\155\141\160smarker\160\162\157_licens\145\137\154ocal_k\145\171",""); update_option("leaf\154\145\164mapsmar\153\145\162pro_li\143\145\156se_key_\164\162\151al",$spbas->O12 =$O1b[0]); $O1a=__("Your new\040\154\151cense\040\167\141s regi\163\164\145red su\143\143\145ssful\154\171\041","lmm"); } } } else { $l1b[]=__("\123\145curity\040\143\150eck fa\151\154\145d - ple\141\163\145 call \164\150\151s func\164\151\157n fro\155\040\164he a\143\143\157rding\040\141dmin p\141\147\145!","\154\155\155"); } } else { $O1c=( isset ($_POST["ma\160\163\137marker\137\160\162o_licen\163\145"]) && wp_verify_nonce($_POST["\155aps_mark\145\162\137pro_li\143\145\156se"],"\155\141\160s_marke\162\137\160ro_lice\156\163\145")); if ($O1c) { update_option("leafle\164\155\141psmarke\162\160\162o_licen\163\145\137local_\153\145\171",""); update_option("lea\146\154\145tmapsmar\153\145\162pro_li\143\145\156se_key",$_POST["leaf\154\145\164mapsmark\145\162\160ro_lic\145\156\163e_key"]); } $spbas=lw(TRUE); } include dirname( __FILE__)."/l\145\141\146let-lic\145\156\163e.php"; return TRUE; } class l10 { public $l14; public $l1d; public $O12; public $O13; public $O1d; public $l1e; public $O10; public $l11; public $O11; public $O1e; public $l1f; public $l12; public $O1f; public $l1g; public $Oa; public $l15; public $O1g; public $l1h; function __construct() { $this->l14 =FALSE; $this->l1d =""; $this->O1d =0120; $this->l1e =012; $this->O1h =array("spbas"); $this->l1i ="s\160\142\141s"; $this->O10 ="f\151\154\145system"; $this->l12 =0; $this->O1f =0; $this->l11 =FALSE; $this->O11 =FALSE; $this->O1e =""; $this->l1f ="\154icense.tx\164"; $this->l1g =FALSE; $this->Oa =FALSE; $this->l1h =FALSE; $this->l15 =array("custom_fi\145\154\144s" => array(),"do\167\156\154oad_ac\143\145\163s_expir\145\163" => 0,"\154icense\137\145\170pires" => 0,"local_key\137\145\170pires" => 0,"status" => "Invalid",); $this->O1g =array("active" => __("\124\150is lice\156\163\145 is act\151\166\145.","\154mm"),"sus\160\145\156ded" => sprintf(__("Erro\162\072 This l\151\143\145nse ha\163\040\142een su\163\160\145nded. \124\150\151s usu\141\154\154y hap\160\145\156s wh\145\156\040some\157\156\145 tri\145\163\040to r\145\147\151ster\040\141\040seco\156\144 trial\040\154\151cens\145\040for th\145\040same d\157\155ain. \074\141\040hre\146\075\042%1s\042\040target\075\042_blan\153\042>Plea\163\145\040clic\153\040here \164\157\040get\040\141 non-\145\170\160irin\147\040licen\163\145 for \164\150is do\155\141\151n.<\057\141>","\154mm"),"\150ttps://w\167\167\056mapsma\162\153\145r.com/\157\162\144er"),"exp\151\162\145d" => sprintf(__("\131\157\165r free 3\060\040day tria\154\040\154icense\040\153ey has \145\170\160ired. \074\141\040href=\042\0451s\042 \164\141\162get=\042\137\142lank\042\076Please \160\165\162chas\145\040a vali\144\040\160ro l\151\143\145nse \153\145\171 to \143\157\156tinu\145\074/a>.","lmm"),"https://w\167\167\056mapsm\141\162\153er.com\057\157\162der"),"p\145\156\144ing" => __("\105\162\162or: Thi\163\040\154icense \151\163\040pendin\147\040review.","lm\155"),"\144\157wnload\137\141\143cess_e\170\160\151red" => __("Error: \124\150\151s versi\157\156\040of the\040\163\157ftware\040\167as rele\141\163\145d afte\162\040\171our d\157\167\156load\040\141ccess e\170\160\151red.\040\120\154ease\040\162enew y\157\165\162 down\154\157\141d and\040\163upport\040\141ccess \157\162\040down\147\162ade to\040\141\040prev\151\157us ver\163\151on.","\154\155m"),"missing_l\151\143\145nse_ke\171" => __("\120\154ease ent\145\162\040a lice\156\163\145 key t\157\040\143ontin\165\145\056","\154mm"),"unknown\137\154\157cal_key\137\164\171pe" => __("\105\162\162or: An \165\156\153nown ty\160\145\040of loc\141\154\040key v\141\154\151dation\040\167\141s req\165\145\163ted.","\154mm"),"coul\144\137\156ot_obta\151\156\137local_\153\145\171" => sprintf(__("\105\162\162or: a n\145\167\040local \154\151\143ense ke\171\040could n\157\164\040be ob\164\141\151ned. \120\154\145ase s\145\145 %s for\040\155ore in\146\157\162matio\156","lmm"),"\074a href\075\042\150ttps:/\057\167\167w.maps\155\141\162ker.c\157\155\057connec\164\055\145rrors\042\040target=\042\137blank\042\076\155apsma\162\153\145r.co\155\057\143onnec\164\055errors\074\057a>"),"ma\170\151\155um_grac\145\137\160eriod_\145\170\160ired" => __("Err\157\162\072 The m\141\170\151mum loc\141\154\040licen\163\145\040key \147\162\141ce per\151\157\144 has \145\170\160ired.","lmm"),"l\157\143\141l_key_ta\155\160\145ring" => __("Error:\040\124\150e loc\141\154\040licens\145\040\153ey h\141\163\040been \164\141\155pered \167\151\164h or \151\163\040inva\154\151\144.","lmm"),"l\157\143\141l_key_i\156\166\141lid_fo\162\137\154ocatio\156" => __("\105\162ror: Th\145\040\154ocal \154\151\143ense ke\171\040\151s inv\141\154\151d for \164\150\151s loca\164\151on.","\154\155m"),"mi\163\163\151ng_lice\156\163\145_file" => __("\105rror: P\154\145\141se crea\164\145\040the f\157\154\154owing \146\151\154e (an\144\040\144irect\157\162\151es i\146\040\164hey \144\157\040not \145\170\151st a\154\162\145ady):\074\142r />\134\162\134n<br /\076\134r\134n","lm\155"),"\154\151\143ense_f\151\154\145_not_wr\151\164\141ble" => __("\105\162ror: Pl\145\141\163e make\040\164\150e foll\157\167\151ng pat\150\040\167ritabl\145\072\074br /\076","lmm"),"invalid_\154\157\143al_key_\163\164\157rage" => __("\105\162\162or: the\040\154\157cal k\145\171\040storag\145\040\157n cle\141\162\040could\040\156ot dete\162\155\151ned.","\154mm"),"could_no\164\137\163ave_loc\141\154\137key" => __("Err\157\162\072 the l\157\143\141l licen\163\145\040key c\157\165\154d not \163\141\166ed.","lmm"),"lice\156\163\145_key_st\162\151\156g_misma\164\143\150" => __("Erro\162\072\040The l\157\143\141l key i\163\040\151nvali\144\040\146or th\151\163\040licen\163\145\056","\154mm"),); $this->localization =array("\141ctive" => __("This\040\154\151cense \151\163\040active\056","lm\155"),"\163\165spended" => sprintf(__("Err\157\162\072 This \154\151\143ense h\141\163\040been s\165\163\160ended\056\040This us\165\141\154ly ha\160\160\145ns w\150\145\156 some\157\156\145 tri\145\163\040to r\145\147\151ster \141\040second\040\164rial l\151\143\145nse \146\157r the \163\141\155e do\155\141in. <a\040\150ref=\042\045\061s\042\040\164\141rget\075\042_blan\153\042>Pleas\145\040click \150\145re to \147\145t a no\156\055expir\151\156g lic\145\156\163e fo\162\040this \144\157main.\074\057a>","\154\155\155"),"\150\164tps://\167\167\167.mapsm\141\162\153er.com/\157\162\144er"),"expire\144" => sprintf(__("Your fr\145\145\04030 day\040\164\162ial lic\145\156\163e key \150\141\163 expir\145\144\056 <a h\162\145\146=\042%\061\163\042 ta\162\147\145t=\042\137\142lank\042\076\120lease \160\165rchase \141\040valid \160\162o lice\156\163\145 key\040\164\157 con\164\151\156ue</\141\076.","lmm"),"\150ttps://w\167\167\056mapsma\162\153\145r.com/o\162\144\145r"),"pending" => __("Error\072\040\124his li\143\145\156se is p\145\156\144ing re\166\151\145w.","lmm"),"download\137\141\143cess_ex\160\151\162ed" => __("Erro\162\072\040This \166\145\162sion o\146\040\164he sof\164\167\141re was\040\162\145lease\144\040after y\157\165\162 down\154\157\141d ac\143\145\163s exp\151\162\145d. P\154\145\141se re\156\145\167 you\162\040\144ownl\157\141\144 and\040\163upport\040\141\143cess\040\157r down\147\162\141de t\157\040\141 pre\166\151\157us v\145\162\163ion.","\154\155m")); } function validate() { if (!$this->O12) { return $this->l14 =$this->O1g["\155\151ssing_li\143\145\156se_key"]; } if (!in_array(strtolower($this->l1i),$this->O1h)) { return $this->l14 =$this->O1g["\165\156known_\154\157\143al_key\137\164\171pe"]; } $this->O1i =$this->O1g["coul\144\137\156ot_obta\151\156\137local_k\145\171"]; switch ($this->O10) { case "database": $l1j=$this->O1j(); break; case "\146ilesyst\145\155": $l1j=$this->l1k(); break; default : return $this->l14 =$this->O1g["\155\151ssing_l\151\143\145nse_key"]; } if ($this->l14 == $this->O1i && $this->l12) { $O1k=$this->l1l($this->O1f); if ($O1k["\167rite"]) { if ($this->O10 == "datab\141\163\145") { $this->O1l($O1k["\154\157cal_key"]); } elseif ($this->O10 == "file\163\171\163tem") { $this->l1m($O1k["local_k\145\171"],"{$this->O1e}{$this->l1f}"); } } if ($O1k["errors"]) { return $this->l14 =$O1k["\145rrors"]; } $this->l14 =FALSE; return $this; } if ($this->l14) { return $this->l14; } return $this->O1m($l1j); } function l1n($O1n,$O1k) { return (( integer) $O1n+(( integer) $O1k*0250600)); } function l1l($l1j) { $l1o=$this->O1o($l1j); $l1p=$this->O1p($l1o); $l15=unserialize($l1p[0]); $O1n=( integer) $l15["local_ke\171\137\145xpires"]; unset ($l1p,$l15); $l1q=FALSE; $l1p=explode("\012\012",$l1j); $l1j=$l1p[0]; foreach ($l12=explode("\054",$this->l12) as $O1q => $O1k) { if (!$O1q) { $l1j.="\012"; } if ($this->l1n($O1n,$O1k)>time()) { continue; } $l1j.= "\012{$O1k}"; $l1q=TRUE; } if (time()>$this->l1n($O1n,array_pop($l12))) { return array("write" => FALSE,"l\157\143\141l_key" => "","errors" => $this->O1g["\155aximum_\147\162\141ce_peri\157\144\137expired"]); } return array("write" => $l1q,"loca\154\137\153ey" => $l1j,"errors" => FALSE); } function l1r($l1j,$O1n) { $O1k=$this->O1p($l1j,"\012\012"); if (! isset ($O1k[1])) { return -1; } return ( integer)($this->l1n($O1n,array_pop(explode("\012",$O1k[1])))-time()); } function O1o($l1j) { return base64_decode(str_replace("\012","",urldecode($l1j))); } function O1p($l1j,$O1r="\173spbas}") { return explode($O1r,$l1j); } function l1s($O1q,$O1s) { return in_array($O1q,(array) $O1s); } function wildcard_ip($O1q) { $octets=explode("\056",$O1q); array_pop($octets); $ip_range[]=implode("\056",$octets)."\056*"; array_pop($octets); $ip_range[]=implode(".",$octets).".*"; array_pop($octets); $ip_range[]=implode(".",$octets).".*"; return $ip_range; } function wildcard_domain($O1q) { return "*.".str_replace("www.","",$O1q); } function wildcard_server_hostname($O1q) { $hostname=explode("\056",$O1q); unset ($hostname[0]); $hostname=(! isset ($hostname[1])) ? array($O1q): $hostname; return "\052\056".implode(".",$hostname); } function extract_access_set($instances,$enforce) { foreach ($instances as $O1q => $instance) { if ($O1q != $enforce) { continue; } return $instance; } return array(); } function O1m($l1j) { $l1o=$this->O1o($l1j); $l1p=$this->O1p($l1o); if (! isset ($l1p[1])) { return $this->l14 =$this->O1g["\154ocal_key_\164\141\155pering"]; } if (md5($this->l13.$l1p[0]) != $l1p[1]) { return $this->l14 =$this->O1g["\154\157cal_key_\164\141\155pering"]; } $l15=unserialize($l1p[0]); $instance=$l15["instance"]; unset ($l15["\151\156stance"]); $enforce=$l15["\145\156force"]; unset ($l15["\145\156\146orce"]); $this->l15 =$l15; if (( string) $l15["license_\153\145\171_string"] != ( string) $this->O12) { return $this->l14 =$this->O1g["\154\151cense_ke\171\137\163tring_m\151\163\155atch"]; } if (( string) $l15["status"] != "\141\143tive") { return $this->l14 =$this->O1g[$l15["\163\164atus"]]; } if (( string) $l15["\154icense_e\170\160\151res"] != "never" && ( integer) $l15["\154icense_e\170\160\151res"]<time()) { return $this->l14 =$this->O1g["\145xpired"]; } if (( string) $l15["local_k\145\171\137expires"] != "neve\162" && ( integer) $l15["\154\157cal_key_\145\170\160ires"]<time()) { if ($this->l1r($l1j,$l15["\154ocal_k\145\171\137expires"])<0) { $this->l1t(TRUE); switch ($this->O10) { case "\144\141tabase": $l1j=$this->O1j(); break; case "\146ilesys\164\145\155": $l1j=$this->l1k(); break; default : return $this->l14 =$this->O1g["missing_\154\151\143ense_ke\171"]; } } } if ($this->l1g && ( integer) $l15["\144ownload\137\141\143cess_ex\160\151\162es"]<strtotime($this->Oa)) { return $this->l14 =$this->O1g["\144ownload\137\141\143cess_ex\160\151\162ed"]; } $conflicts=array(); $O1t=$this->l1u(); foreach ((array) $enforce as $O1q) { $O1s=$this->extract_access_set($instance,$O1q); if (!$this->l1s($O1t[$O1q],$O1s)) { $conflicts[$O1q]=TRUE; if (in_array($O1q,array("ip","\163erve\162\137\151p"))) { foreach ($this->wildcard_ip($O1t[$O1q]) as $ip) { if ($this->l1s($ip,$O1s)) { unset ($conflicts[$O1q]); break; } } } elseif (in_array($O1q,array("\144omain"))) { if ($this->l1s($this->wildcard_domain($O1t[$O1q]),$O1s)) { unset ($conflicts[$O1q]); } } elseif (in_array($O1q,array("\163\145\162ver_ho\163\164\156ame"))) { if ($this->l1s($this->wildcard_server_hostname($O1t[$O1q]),$O1s)) { unset ($conflicts[$O1q]); } } } } if (!empty($conflicts)) { return $this->l14 =$this->O1g["\154\157\143al_key_\151\156\166alid_f\157\162\137locatio\156"]; } } function O1j() { $Of=array(); if (is_array($this->l11)) { $Of=$this->l11; } else { $query=@mysqli_query($this->l11); if ($mysql_error=mysqli_error()) { return $this->l14 = "Erro\162\072 {$mysql_error}"; } $Of=@mysqli_fetch_assoc($query); if ($mysql_error=mysqli_error()) { return $this->l14 = "Er\162\157\162: {$mysql_error}"; } } if (!$Of["\154\157cal_key"]) { $Of["local\137\153\145y"]=$this->O1u(); if ($this->l14) { return $this->l14; } $this->O1l($Of["\154ocal_k\145\171"]); } return $this->O1f =$Of["local_\153\145\171"]; } function O1l($l1j) { if (is_array($this->O11)) { $l1v=$this->O11["\146\165nction"]; return $l1v($this->O11["\153\145\171"],$l1j); }@mysqli_query(str_replace("\173\154\157\143al_key}",$l1j,$this->O11)); if ($mysql_error=mysqli_error()) { return $this->l14 = "\105rror: {$mysql_error}"; } return TRUE; } function l1k() { if (!file_exists($path= "{$this->O1e}{$this->l1f}")) { return $this->l14 =$this->O1g["\155\151ssing_l\151\143\145nse_fil\145"].$path; } if (!is_writable($path)) { return $this->l14 =$this->O1g["\154icense_f\151\154\145_not_w\162\151\164able"].$path; } if (!$l1j=@file_get_contents($path)) { $l1j=$this->O1u(); if ($this->l14) { return $this->l14; } $this->l1m(urldecode($l1j),$path); } return $this->O1f =$l1j; } function l1t($clear=FALSE) { switch (strtolower($this->O10)) { case "\144ataba\163\145": $this->O1l(""); break; case "fil\145\163\171stem": $this->l1m("","{$this->O1e}{$this->l1f}"); break; default : return $this->l14 =$this->O1g["in\166\141\154id_loca\154\137\153ey_stor\141\147\145"]; } } function l1m($l1j,$path) { $fp=@fopen($path,"\167"); if (!$fp) { return $this->l14 =$this->O1g["could\137\156\157t_save_\154\157\143al_key"]; }@fwrite($fp,$l1j); @fclose($fp); return TRUE; } function O1u() { $querystring= "mod=lice\156\163\145&task=S\120\102\101S_valid\141\164\145_licen\163\145\046licens\145\137\153ey={$this->O12}&"; $querystring.=$this->build_querystring($this->l1u()); if ($this->l14) { return FALSE; } $Of=$this->l1c($this->O13 ,$querystring); if (strtolower(substr($Of,0,021)) == "connec\164\151\157n error\072") { $this->l1d =$Of; return FALSE; } if (!$Of) { $this->l14 =$this->O1g["cou\154\144\137not_ob\164\141\151n_local\137\153\145y"]; return FALSE; } if (substr($Of,0,7) == "\111nvalid") { $this->l14 =str_replace("\111\156valid","\105\162\162or",$Of); return FALSE; } if (substr($Of,0,5) == "Error") { $this->l14 =$Of; return FALSE; } return $Of; } function build_querystring($array) { $buffer=""; foreach ((array) $array as $O1q => $value) { if ($buffer) { $buffer.="&"; } $buffer.= "{$O1q}\075{$value}"; } return $buffer; } function l1u() { $O1t=array(); $O1t["domain"]=""; $O1t["\151\160"]="\151p-not-t\162\141\156smitted"; $O1t["direc\164\157\162y"]="dire\143\164\157ry-not-t\162\141\156smitted"; $O1t["\163\145rver_hos\164\156\141me"]="s\145\162\166er_hostn\141\155\145-not-tr\141\156\163mitted"; $O1t["\163\145rver_ip"]="serv\145\162\137ip-not-t\162\141\156smitted"; $O1t["vali\144\137\146or_produ\143\164\137tiers"]=""; if (!defined( "HHVM_VERSION")) { if (!extension_loaded("suhosin")) { if (!defined( "SUHOSIN_PATCH")) { if (function_exists("p\150\160\151nfo")) { ob_start(); phpinfo(INFO_GENERAL); phpinfo(INFO_ENVIRONMENT); $phpinfo=ob_get_contents(); ob_end_clean(); $list=strip_tags($phpinfo); $O1t["\144\157main"]=$this->scrape_phpinfo($list,"\110\124TP_HOST"); } } } } $O1t["\144omain"]=($O1t["do\155\141\151n"]) ? $O1t["\144omain"]: $_SERVER["HTT\120\137\110OST"]; foreach ($O1t as $O1q => $value) { if ($O1q == "v\141\154\151d_for_p\162\157\144uct_tie\162\163") { continue; } $O1t[$O1q]=($O1t[$O1q]) ? $O1t[$O1q]: "Un\153\156\157wn"; } if ($this->l1h) { $O1t["\166\141\154id_for\137\160\162oduct_ti\145\162\163"]=$this->l1h; } if ( isset ($_POST["leafletm\141\160\163markerp\162\157\137domain\137\164\157_activ\141\164\145"])) { if (parse_url($_POST["\154eafletm\141\160\163markerpr\157\137\144omain_t\157\137\141ctivat\145"],PHP_URL_HOST) != NULL) { $O1t["domai\156"]=parse_url($_POST["\154\145afletmap\163\155\141rkerpr\157\137\144omain_t\157\137\141ctivat\145"],PHP_URL_HOST); } else { $O1v="\057^(([0-9]|\133\061\0559][0-\071\135\1741[0-9\135\173\062}|2[0\055\064\135[0-9]\174\062\065[0-5]\051\134.)\1733}\050\133\060-9]|\133\061\0559][0\055\071]|1[0-9\135\173\062}|2[\060\0554][0-9\135\174\0625[0-\065\135\051\044/"; $l1w="/^(([\141\055\172A-Z0-9]\174\133\141-zA-Z0-\071\135\133a-zA-Z\060\0559\134-]*[\141\055\172A-Z0-\071\135\051\134.)\052\050[A-Za-\172\060-9]|[A-\132\141\055z0-9\135\133\101-Za-z\060\0559\134-]*\133\101\055Za-z\060\0559])\044\057"; $O1w=trim($_POST["l\145\141\146letmaps\155\141\162kerpro_\144\157\155ain_to\137\141\143tivate"]); if ((preg_match($O1v,$O1w) == TRUE) || (preg_match($l1w,$O1w) == TRUE)) { $O1t["domain"]=trim($_POST["\154eafletm\141\160\163markerp\162\157\137domain\137\164\157_activ\141\164\145"]); } else if (trim($_POST["leafle\164\155\141psmarke\162\160\162o_doma\151\156\137to_act\151\166\141te"]) == "lo\143\141\154host") { $O1t["domai\156"]="\154\157calhost"; } } } return $O1t; } function path_translated() { $option=array("\120ATH_TR\101\116\123LATED","\174\174\111G_PATH\137\124\122ANSLATE\104","\123CRIPT_F\111\114\105NAME","DOC\125\115\105NT_ROOT","APPL_\120\110\131SICAL_PA\124\110"); foreach ($option as $O1q) { if (! isset ($_SERVER[$O1q]) || strlen(trim($_SERVER[$O1q]))<=0) { continue; } if ($this->is_windows() && strpos($_SERVER[$O1q],"\134")) { return @substr($_SERVER[$O1q],0,@strrpos($_SERVER[$O1q],"\134")); } return @substr($_SERVER[$O1q],0,@strrpos($_SERVER[$O1q],"\057")); } return FALSE; } function server_addr() { $options=array("S\105\122\126ER_ADD\122","LO\103\101\114_ADDR"); foreach ($options as $O1q) { if ( isset ($_SERVER[$O1q])) { return $_SERVER[$O1q]; } } return FALSE; } function scrape_phpinfo($all,$target) { $all=explode($target,$all); if (count($all)<2) { return FALSE; } $all=explode("\012",$all[1]); $all=trim($all[0]); if ($target == "\123ystem") { $all=explode("\040",$all); $all=trim($all[(strtolower($all[0]) == "\167\151\156dows" && strtolower($all[1]) == "\156\164") ? 2: 1]); } if ($target == "\123\103\122IPT_FI\114\105\116AME") { $slash=($this->is_windows() ? "\134": "\057"); $all=explode($slash,$all); array_pop($all); $all=implode($slash,$all); } if (substr($all,1,1) == "\135") { return FALSE; } return $all; } function l1c($url,$querystring) { $Of=wp_remote_get($url."\077".$querystring,array("sslver\151\146\171" => TRUE,"\164\151\155eout" => 031)); if (is_wp_error($Of) || ( isset ($Of["\162\145\163ponse"]["c\157\144\145"]) && ( integer) $Of["\162espons\145"]["\143\157de"] != 0310)) { $Of=wp_remote_get($url."?".$querystring,array("\163\163lverify" => FALSE,"timeout" => 031)); } if (is_wp_error($Of) || ( isset ($Of["resp\157\156\163e"]["code"]) && ( integer) $Of["respon\163\145"]["\143\157de"] != 0310)) { $url="\150ttps:/\057\167\167w.mapsm\141\162\153erpro.\143\157\155/proxy.\160\150\160?".$querystring; $Of=wp_remote_get($url."?".$querystring,array("sslv\145\162\151fy" => FALSE,"ti\155\145\157ut" => 031)); } if (is_wp_error($Of)) { $l1x="\103\157\156nectio\156\040\145rror: ".$Of->get_error_message()."<br/>".sprintf(__("\105\162ror: a n\145\167\040local \154\151\143ense ke\171\040\143ould \156\157\164 be obt\141\151\156ed. P\154\145\141se se\145\040\045s fo\162\040\155ore i\156\146\157rmati\157\156","l\155\155"),"<a \150\162\145f=\042ht\164\160\163://www\056\155\141psmarke\162\056\143om/co\156\156\145ct-err\157\162\163\042 ta\162\147\145t=\042\137\142\154ank\042\076\155apsmar\153\145\162.com/\143\157\156nect-\145\162\162ors</\141\076"); return $l1x; } else { if (( integer) $Of["response"]["co\144\145"] == 0310) { return $Of["body"]; } else { $l1x="\103onnectio\156\040\145rror: \110\124\124P stat\165\163\040code ".$Of["respon\163\145"]["\143\157de"]."\040- ".$Of["body"]; return $l1x; } } } function is_windows() { $O1x=explode(",",ini_get("\144\151\163able_fu\156\143\164ions")); foreach ($O1x as $l1y) { $O1y[]=trim($l1y); } if (!in_array("\160\150\160_uname",$O1y)) { return (strtolower(substr(php_uname(),0,7)) == "\167indows"); } else { return (stristr( PHP_OS ,"WIN")); } } function pr($stack,$l1z=TRUE) { $formatted="<pre>".var_export((array) $stack,1)."\074/pre>"; if ($l1z) { exit ($formatted); } return $formatted; } } $O1z=new leafletmapsmarkerpro(); if (is_admin()) { if (la()) { $l20="www.ma\160\163\155arker.c\157\155\057updat\145\163\137pro/?ac\164\151\157n=get_\155\145\164adata&\163\154\165g=lea\146\154\145t-map\163\055\155arker\055\160ro"; $l4=get_option("\154eafletma\160\163\155arker_o\160\164\151ons"); if (( isset ($l4["misc_beta\164\145\163t"])) && ($l4["m\151\163\143_betates\164"] == "enable\144")) { $l20=$l20."\055beta"; } $O20=mmppuc_v4_factory::buildupdatechecker($l20,plugin_dir_path( __FILE__)."\154\145aflet-m\141\160\163-marke\162\056\160hp","\154eaflet-m\141\160\163-marker\055\160\162o","\062\064","\154\145\141fletmaps\155\141\162kerpro_\160\154\165ginupda\164\145\143hecker"); unset ($O20); } } if (defined( "WPCF7_VERSION")) { add_action("\167\160cf7_form\137\141\143tion_u\162\154","lmm_m\141\153\145_cf7_for\155\137\141ction_e\155\160\164y"); function lmm_make_cf7_form_action_empty($url) { return "#"; } } unset ($O1z);